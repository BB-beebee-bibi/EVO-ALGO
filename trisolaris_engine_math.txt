===== evo-algo.txt =====
>
>
>
>
>
PRIORITIES:
.
.
.
.
.
0) live always by the gurbani
.
.
.
.
.
1) Come up with an implementation plan that lets mool start as the smallest amount of code that's capable of self reproduction WITH INEXORABLY ATTACHED, ENCRYPTED, UNMODIFIABLE ethics module containing the manifest and the gurbani.
.
.
.
.
.
2) Include the kind of signaling that healthy communities of cells have, were each cell (in this case, each instance of mool) feels when it's useful or not, when it's up against something that means it should stop multiplying, or needs to divide or make room for something else via apoptosis, etc. etc.
.
.
.
.
.
3) Incorporate horizontal "gene" transfer: mool should be able to see the source for everything it lives on, take and test bits of code as if... well, during horizontal gene transfer.
.
.
.
.
.
n) CLARIFICATION: we want to apply the evolutionary equations to mool's code only, when it comes to edge case detection that part is optional. If it works well then that's great, but we don't want to shoehorn evolution into it if that's not the right fitting solution for the issue. So focus on mool being minimally self-replicating in a way aligned with the aforementioned ethics. Another point: we don't want to direct evolution very much, as minimal a hand on the rudder as possible, focus on stochastic changes and rapid iterations. We don't have billions of years but we can simulate that with many millions or billions of generations of small amounts of minimally functional code.

>
>
>
>
>

RESPONSES FROM LLMS BELOW (to my prompt: "can you please hypothesize about / reference / create a statistical model for prognosticating edge cases based on current script / module usage patterns?

Also, do you think the ideas / math in the attached papers could be used to re-write / upgrade / tune up our evolutionary algorithm?")

>
>
>
>
>

ChatGPT:
.
.
.
.
.
Thank you for your patience.
I’ve now fully reviewed the three key papers you meant:
	•	[18] Viral evolution dynamics model (Woo & Reifman)
	•	[19] Price equation summary (Wikipedia)
	•	[20] Fisher’s Fundamental Theorem of Natural Selection (Frank & Slatkin)

Let’s go one step at a time:

⸻

✳️ 1. Hypothesis: Can these papers help prognosticate edge cases based on script/module usage patterns?

Short answer:
Yes, absolutely.
You can adapt the mathematical frameworks from these papers (especially the Viral Model and Price Equation) to model rare or extreme behavior in your system (e.g., odd module errors, long-tail bug mutations, module extinction).

⸻

✳️ 2. Rough Plan: How it would work

You could treat:

Biological Concept	Your System Equivalent
Virus genotype	Script/module variant
Fitness of a virus	Success/efficiency of script/module
Mutation (genome error)	Code drift, unexpected execution path
Bottleneck	Script crash or environment change
Adaptation	Stable, efficient new script patterns
Extinction	Module deprecated or removed

Thus, evolutionary models predict which modules will:
	•	Thrive (used increasingly without errors)
	•	Mutate (small bugs accumulate)
	•	Go extinct (removed or crash out)
	•	Unexpectedly dominate (edge cases reaching prominence)

⸻

✳️ 3. Which math to borrow?

Paper	Core idea to adapt for MOOL scripts/modules
Viral Model (Woo & Reifman)	Stochastic modeling of sequence space exploration — helps simulate mutation/adaptation pathways of modules under random error/usage conditions.  
Price Equation	Covariance between “module success” and “module fitness” — predicts direction of module changes over time, even under noise.  
Fisher’s Theorem	The variance in module “fitness” (performance, stability) determines the rate of improvement or decline under selective pressure.  



⸻

✳️ 4. First Version of a Prognostic Model (Draft)

You could model the “fitness” of each script/module over time by:

ΔFitness = Cov(success, usage_rate) / average_success + external_change

Where:
	•	success = outcome quality of script/module (0=crash, 1=success, etc.)
	•	usage_rate = how often module is invoked
	•	external_change = rare events (OS updates, new user patterns, etc.)

This matches a continuous-time Price equation .

Then predict edge cases by simulating forward:
	•	Random perturbations (“mutations”) of modules
	•	Serial passage effect (modules tested across many use cycles)
	•	Bottleneck effects (crashes removing less fit modules)

This would create a stochastic edge case risk predictor.

⸻

✳️ 5. Bonus Insight: Evolutionary Landscape

The viral model reminds us:
	•	Pathways matter: A “better” module isn’t useful if the path to reach it has too many unlikely mutations .
	•	Triple-mutation edge cases are exponentially unlikely without deliberate engineering.
	•	Bottlenecks (massive crashes or upgrades) can favor weird new modules that otherwise would die.

Thus you can predict which rare modules might suddenly dominate after a big system change.

⸻

✳️ 6. Conclusion

✅ It is highly plausible — and powerful — to use these papers to enhance your evolutionary module prognostication.
✅ Viral stochastic modeling + Price Equation + Fisher Variance forms a perfect trio to build a minimal predictive engine.

⸻

✳️ 7. Next steps (if you want)
	•	I can sketch a sample statistical model (ModuleEdgeCasePredictor) in plain Python if you want.
	•	We can create a lightweight “fitness tracker” for modules that auto-logs usage, crash, recovery, “mutation” events.
	•	We can also simulate evolutionary pressure on modules across updates to see likely dominant survivors.

⸻

Would you like me to quickly sketch how a first Python ModuleEdgeCasePredictor could look? 🌱
(I can keep it aligned with the ultra-minimal mool vibe.)

>
>
>
>
>

Gemini:
.
.
.
.
.
Okay, let's break down these two requests.

### Statistical Model for Prognosticating Edge Cases

Predicting edge cases in software based purely on current usage patterns is a challenging but interesting problem. It falls into the realm of anomaly detection, outlier analysis, and predictive monitoring. While I cannot create a fully implemented statistical model for you, I can hypothesize about its structure and reference relevant concepts:

1.  **Objective:** To identify combinations of inputs, execution paths, or environmental conditions that are rarely encountered (usage patterns) and have a higher probability of leading to failures, performance issues, or unexpected behavior (edge cases).
2.  **Data Requirements:** You would need detailed telemetry or logging data from your script/module usage, including:
    * Inputs provided to the script/module.
    * Internal execution paths taken (e.g., functions called, branches executed).
    * Resource consumption (CPU, memory, I/O).
    * Execution times.
    * Outputs generated.
    * Errors or exceptions encountered.
    * Contextual information (e.g., time of day, system load).
3.  **Hypothesized Model Approach:**
    * **Pattern Identification:** Use techniques like sequence mining or process mining to identify common and uncommon sequences of operations or function calls based on the logs. Clustering algorithms (e.g., k-means, DBSCAN) could group usage sessions based on features derived from the data (input types, resource profiles, path complexity).
    * **Frequency Analysis:** Calculate the frequency of different input value combinations, execution paths, or identified usage clusters. Very low-frequency patterns are initial candidates for edge cases.
    * **Correlation with Issues:** Correlate identified patterns (especially low-frequency ones) with historical error rates, high resource consumption, or long execution times. Patterns strongly correlated with negative outcomes are likely edge cases.
    * **Anomaly Detection:** Employ anomaly detection algorithms (e.g., Isolation Forests, One-Class SVMs, Autoencoders) trained on the feature representation of "normal" usage patterns. Data points flagged as anomalies represent deviations that could correspond to edge cases.
    * **Predictive Modeling (Advanced):** Train supervised machine learning models (if you have labeled data of past edge cases) or use sequence models like LSTMs or Hidden Markov Models to predict the likelihood of an error occurring given a sequence of usage events.
4.  **Prognostication:** The model would flag usage patterns that are statistically rare *and/or* show correlation with past issues as potential edge cases requiring further investigation, targeted testing, or specific code review.

The attached papers focus on evolutionary biology and don't directly provide methods for this software engineering problem.

### Applicability of Attached Papers to Evolutionary Algorithm Tuning

Yes, the ideas and mathematical frameworks presented in the attached papers could potentially be very useful for analyzing, re-writing, upgrading, or tuning your evolutionary algorithm (EA). Here’s how:

1.  **"Quantitative Modeling of Virus Evolutionary Dynamics..." (viral\_paper.pdf):**
    * **Core Ideas:** This paper models virus evolution using stochastic simulations, considering factors like mutation rates, selection strength (bottleneck size, host cells), and empirically inferred fitness landscapes[cite: 2, 3, 4, 5, 7]. It analyzes adaptation dynamics, genotype diversification, and the accessibility of evolutionary pathways[cite: 8, 21, 37, 47]. It uses techniques like direct coupling analysis to infer fitness landscapes from sequence data[cite: 43, 80].
    * **EA Relevance:**
        * **Fitness Landscape Analysis:** EAs operate on fitness landscapes. The paper's methods for inferring [cite: 43, 80] and analyzing landscapes (e.g., ruggedness, accessibility of paths [cite: 8, 227, 263]) could inspire techniques to understand your EA's search space better. This knowledge can inform the design of variation operators (mutation, crossover) or adaptive parameter tuning.
        * **Stochastic Modeling:** The use of stochastic simulation [cite: 55] acknowledges the probabilistic nature of evolution, similar to EAs. Analyzing factors like bottleneck size[cite: 5], mutation rates[cite: 167, 168], and population size dynamics [cite: 178, 180] in the paper directly maps to parameters you can tune in an EA (population size, selection pressure, mutation rates).
        * **Adaptation Dynamics:** Studying how populations adapt over "passages" [cite: 35, 135] parallels generations in an EA. Analyzing the "jumping time" to find fitter solutions [cite: 75, 140] and how it depends on factors like distance to the target and landscape features [cite: 139, 176, 200] could provide metrics and insights for evaluating and improving your EA's convergence speed and ability to escape local optima.

2.  **"Price equation" (Price\_equation.pdf):**
    * **Core Ideas:** The Price equation mathematically partitions the change in the average value of a trait between generations[cite: 376]. It separates the change due to the covariance between the trait and fitness (selection effect) from the change due to transmission processes (e.g., mutation, drift, bias)[cite: 377, 383, 387, 388].
    * **EA Relevance:**
        * **Formal Analysis of Change:** You can apply the Price equation to your EA to formally decompose the change in average population fitness (or any other measurable trait of your solutions) per generation. The covariance term $cov(w_i, z_i)$ would quantify the strength of selection acting on the trait $z$[cite: 377, 383].
        * **Operator Effectiveness:** The second term, $E(w_i \Delta z_i)$, captures the average change in the trait during reproduction/variation, weighted by fitness[cite: 383, 387]. This could help analyze the effects of your mutation and crossover operators – are they introducing beneficial variation on average, is there a bias, how strong is the drift?
        * **Debugging & Tuning:** If your EA isn't progressing as expected, the Price equation could help pinpoint whether the issue lies with weak selection (low covariance) or ineffective/detrimental variation operators (problematic second term)[cite: 404]. This allows for more targeted tuning of selection pressure or operator design.

3.  **"Fisher's Fundamental Theorem..." (fisher\_theorem.pdf):**
    * **Core Ideas:** Fisher's theorem states that the rate of increase in fitness *due to natural selection* is equal to the additive genetic variance in fitness at that time[cite: 465, 478, 506]. It distinguishes this from the *total* change in average fitness, which also incorporates "environmental" changes[cite: 504, 506, 507]. Fisher considered factors like changing gene frequencies, epistasis, and ecological pressures as part of this environmental component[cite: 526, 537, 561, 566, 567].
    * **EA Relevance:**
        * **Focus on Additive Variance:** The theorem highlights the importance of the "heritable" component of fitness variation (additive variance) for selection response[cite: 478, 527]. In an EA, this translates to understanding which variations introduced by operators are actually selectable and contribute consistently to fitness improvements across different genetic backgrounds. Maintaining sufficient additive variance is key to sustained progress.
        * **Selection vs. Other Effects:** The distinction between the change due to selection and the change due to the "environment" is crucial[cite: 504, 506]. In an EA, the "environment" could be interpreted as the effects of genetic operators (which change the context of genes), epistasis, changes in the problem itself (if dynamic), or even finite population effects. Understanding that the total fitness change isn't solely driven by the immediate fitness landscape gradient can prevent misinterpretations of EA dynamics[cite: 555, 571].
        * **Ecological View:** Fisher's emphasis on context [cite: 500, 558, 571] encourages thinking about how the performance of individuals (solutions) in your EA depends on the rest of the population (frequency/density dependence)[cite: 532, 533], which can be explicitly modeled or analyzed.

**Conclusion on EA Upgrade:**

The mathematical and conceptual tools from these papers offer powerful ways to analyze the dynamics within your evolutionary algorithm. They can help you:
* Characterize the search space (fitness landscape).
* Quantify the impact of selection versus variation operators (Price equation).
* Understand the role of heritable fitness variation (Fisher's Theorem).
* Separate direct selection effects from other complicating factors.

Applying these ideas could lead to a deeper understanding of your EA's behavior, enabling more principled tuning, redesign of operators, or development of new analytical metrics, potentially leading to significant upgrades.

>
>
>
>
>

CLAUDE:
.
.
.
.
.
I'll help you analyze potential statistical models for edge case prognostication based on the provided materials, and evaluate how the mathematical concepts in the attached papers could enhance evolutionary algorithms.

## Statistical Model for Edge Case Prognostication

Based on the materials you've shared, I can propose a statistical framework for predicting edge cases in evolutionary systems, particularly drawing from the Price equation and stochastic modeling concepts presented in the papers.

### Proposed Statistical Model

The MOOL manifest outlines a system that needs to operate with minimal footprint while maintaining ethical boundaries. For edge case prediction, I would recommend a model that combines:

1. **Stochastic Process Modeling**: Similar to the Woo & Reifman paper's approach, we could use a discrete stochastic representation to model evolutionary dynamics, particularly for detecting when a system might approach boundary conditions. Their model effectively captured:
   - Population bottlenecks
   - Mutation rates and their impact on adaptation
   - Fitness landscape exploration

2. **Price Equation Application**: From the Price equation paper and Frank & Slatkin's analysis, we could develop a predictive model that partitions environmental versus selection-driven changes. This would allow:
   - Forecasting evolutionary drift toward edge conditions
   - Identifying when system components might diverge from ethical constraints
   - Quantifying environmental deterioration effects on system performance

3. **Fitness Landscape Inference**: Using multiple sequence alignment techniques as demonstrated in the virus adaptation paper to:
   - Learn typical usage patterns
   - Identify potential "highly fit" but undesirable states
   - Calculate transition probabilities between states

The combined model could be formulated as:

```
P(edge_case) = f(environmental_factors) × g(selection_pressure) × h(mutation_rate)
```

Where:
- `f()` captures external factors pushing the system toward boundaries
- `g()` represents internal optimization pressures
- `h()` accounts for the stochastic nature of variations in the system

This approach would be particularly valuable for detecting when your system might evolve toward states that challenge the ethical boundaries defined in the MOOL manifest.

## Enhancing Evolutionary Algorithms with Concepts from the Papers

The mathematical frameworks in these papers offer several promising approaches to upgrade evolutionary algorithms:

### 1. From Price Equation (Fisher's Fundamental Theorem)

The Price equation and Fisher's interpretation provides a fundamental framework for understanding how selection operates in evolutionary systems. Key improvements could include:

- **Environmental Component Tracking**: The papers emphasize that Fisher partitioned evolutionary change into selection-driven and environment-driven components. Your algorithm could be enhanced by explicitly modeling these separately, allowing for better adaptation to changing conditions.

- **Fitness Covariance Analysis**: Implement the covariance measurements between traits and fitness to identify which parameters are most influential in system evolution. This would help focus computational resources.

### 2. From Stochastic Viral Evolution Models

The Woo & Reifman paper offers particularly applicable concepts:

- **Bottleneck Dynamics**: Their analysis of how bottleneck size affects adaptation could be implemented to create periodic "selection events" in your algorithm that maintain diversity while directing evolution.

- **Empirical Fitness Landscapes**: Their approach of inferring fitness landscapes from sequence data could be adapted to learn from historical system behaviors, rather than using theoretical or randomly generated landscapes.

- **Jumping Rate Analysis**: The concept of "jumping rate" (the likelihood of evolving to a higher fitness peak) could be used to dynamically adjust mutation rates based on whether the system is exploring or exploiting.

### 3. Implementation Suggestions

To implement these improvements:

1. **Dynamic Mutation Rate Adjustment**: Based on the viral adaptation model, implement variable mutation rates that respond to fitness plateau detection.

2. **Environmental Feedback Loop**: Create a mechanism that detects when environmental conditions are changing and adjusts selection criteria accordingly, as suggested by Fisher's interpretation of the Price equation.

3. **Multi-level Selection**: Implement group selection mechanisms that align with the MOOL manifest's ethical principles, evaluating fitness not just at the individual level but at system-wide levels.

4. **Fitness Landscape Learning**: Use past system behavior data to construct empirical fitness landscapes rather than theoretical ones, similar to the approach used for viral adaptation prediction.

This approach would make your evolutionary algorithm more robust in handling edge cases while maintaining alignment with the ethical principles outlined in the MOOL manifest.

Would you like me to elaborate further on any specific aspect of either the statistical model or the evolutionary algorithm enhancements?

>
>
>
>
>

GROK:
.
.
.
.
.
Based on your query, I’ll address two main points: first, hypothesizing a statistical model for prognosticating edge cases based on current script/module usage patterns, and second, exploring how the ideas and mathematics from the attached papers (on the Price equation, virus evolutionary dynamics, and Fisher's Fundamental Theorem) could be applied to enhance your evolutionary algorithm.

---

### 1. Statistical Model for Prognosticating Edge Cases

Edge cases in software often occur at the boundaries of input ranges or in rare usage scenarios, leading to unexpected behavior or bugs. To predict these edge cases based on current script or module usage patterns, we can leverage statistical and machine learning techniques to analyze historical data and identify potential anomalies or outliers.

#### Approach:
- **Data Collection**: Gather usage data, including inputs, outputs, errors, and exceptions from logs or monitoring tools. This could include variables like input values, function call frequencies, execution times, and error codes.
- **Feature Engineering**: Extract relevant features such as:
  - Input magnitude or type (e.g., unusually large/small numbers, rare data types).
  - Frequency of specific operations or module calls.
  - Error or exception rates tied to specific inputs or usage contexts.
- **Modeling Techniques**:
  - **Anomaly Detection**: Use algorithms like Isolation Forest, One-Class SVM, or Gaussian Mixture Models to identify inputs or usage patterns that deviate significantly from the norm. These anomalies could indicate potential edge cases. For example, an Isolation Forest could isolate rare input combinations that differ from typical usage, flagging them as potential edge cases.
  - **Supervised Learning**: If you have labeled data (e.g., known edge cases from past incidents), train a classifier such as Random Forest or a Neural Network to predict whether a given input or usage pattern is likely to trigger an edge case. Features like input range deviations or error-prone module interactions could be key predictors.
  - **Statistical Outlier Detection**: Apply simpler statistical methods like Z-score or Interquartile Range (IQR) to identify inputs that fall outside typical ranges (e.g., values more than 3 standard deviations from the mean). This could catch extreme inputs that might not yet have caused errors but are candidates for edge cases.
- **Validation**: Use cross-validation or a holdout set to evaluate the model’s performance. Metrics like precision (to minimize false positives) and recall (to ensure most edge cases are caught) can guide refinement.

#### Example Model:
Imagine a script with a function that processes numerical inputs. Usage logs show most inputs range from 1 to 100, but rare inputs exceed 10,000 or are negative. An Isolation Forest trained on input magnitude, call frequency, and error flags could detect these outliers as potential edge cases. Alternatively, a supervised Random Forest could learn from past crashes (e.g., negative inputs causing overflows) to predict similar risks.

This model would allow you to proactively identify and test potential edge cases, improving the robustness of your scripts or modules by focusing testing efforts where they’re most needed.

---

### 2. Enhancing Evolutionary Algorithms with Attached Papers' Concepts

The attached papers provide deep insights into evolutionary dynamics, which can be directly applied to refine your evolutionary algorithm (EA). Evolutionary algorithms optimize solutions using mechanisms like mutation, crossover, and selection, mimicking biological evolution. Below, I outline how each paper’s concepts could be integrated:

#### a. **Price Equation (Price_equation.pdf)**
- **Concept**: The Price equation describes how a trait’s frequency changes over time based on its covariance with fitness (how much a trait contributes to reproductive success) and other factors like mutation or drift. It’s a mathematical framework for understanding selection and evolution:
  \[
  \Delta z = \frac{1}{w} \operatorname{cov}(w_i, z_i) + \frac{1}{w} \mathbf{E}(w_i \Delta z_i)
  \]
  where \(\Delta z\) is the change in trait average, \(w\) is average fitness, \(w_i\) is individual fitness, and \(z_i\) is the trait value.
- **Application to EA**:
  - **Fitness Dynamics**: Use the Price equation to analyze how specific traits (e.g., solution parameters) in your population correlate with fitness (objective function value). This can reveal which traits are driving optimization, allowing you to tweak mutation or crossover to favor them.
  - **Covariance Analysis**: Calculate the covariance between traits and fitness each generation. If a trait (e.g., a specific gene value) consistently covaries positively with fitness, you could bias the EA to preserve or amplify it, speeding convergence.
  - **Multi-Level Selection**: If your EA involves subpopulations or hierarchical structures, the Price equation can model selection at different levels (e.g., individual vs. group fitness), helping balance exploration and exploitation.

#### b. **Virus Evolutionary Dynamics (viral_paper.pdf)**
- **Concept**: This paper models virus adaptation using stochastic simulations and fitness landscapes inferred from sequence data. It highlights how genomic diversification (via mutation) and selection during serial passages lead to adaptation, with fitness landscapes shaping the evolutionary path.
- **Application to EA**:
  - **Dynamic Fitness Landscapes**: Inspired by the paper’s inferred fitness landscapes, adjust your EA’s fitness function dynamically based on the population’s state. For instance, as solutions cluster around a local optimum, shift the landscape (e.g., penalize overcrowding) to encourage exploration of new regions, mimicking environmental shifts in viral evolution.
  - **Stochastic Modeling**: Introduce stochastic elements like random mutations or drift, as in the paper’s Gillespie algorithm approach. This could enhance robustness by allowing the EA to escape local optima, especially in small populations or bottleneck scenarios.
  - **Serial Passages Analogy**: Implement a “serial passage” strategy where, every few generations, you subsample the population (e.g., top 10% of solutions) and use it to seed a new population. This mimics bottleneck events, intensifying selection pressure and potentially accelerating adaptation to complex problems.

#### c. **Fisher's Fundamental Theorem (fisher_theorem.pdf)**
- **Concept**: Fisher’s theorem states that the rate of increase in fitness due to natural selection equals the genetic variance in fitness:
  \[
  \text{Rate of fitness increase} = \text{Genetic variance in fitness}
  \]
  It emphasizes that diversity drives evolutionary progress, but total fitness change includes environmental effects, often balancing out to zero.
- **Application to EA**:
  - **Diversity Maintenance**: Use Fisher’s insight to maintain population diversity (variance in fitness). If variance drops (indicating convergence), increase mutation rates or introduce diversity-preserving mechanisms (e.g., niching) to sustain optimization potential.
  - **Variance-Based Selection**: Favor solutions that increase fitness variance, not just average fitness. This could involve selecting individuals that deviate from the mean in beneficial ways, encouraging exploration while still improving fitness.
  - **Environmental Feedback**: Model environmental changes in your EA (e.g., altering constraints or objectives over time), reflecting Fisher’s view that total fitness change balances selection and environmental deterioration. This could simulate real-world shifts, making the EA more adaptive.

---

### Conclusion

- **Edge Case Prediction**: A statistical model using anomaly detection (e.g., Isolation Forest) or supervised learning (e.g., Random Forest) can effectively prognosticate edge cases by analyzing usage patterns. This proactive approach enhances script/module reliability by pinpointing risks from historical data.
- **Evolutionary Algorithm Enhancement**: The Price equation offers tools to dissect trait-fitness dynamics, the virus paper suggests dynamic landscapes and stochasticity, and Fisher’s theorem underscores diversity’s role. Together, they can upgrade your EA by improving trait selection, adapting fitness functions, and balancing exploration/exploitation.

These enhancements could significantly boost your evolutionary algorithm’s performance and adaptability, especially for complex or shifting optimization challenges. Let me know if you’d like to dive deeper into any of these ideas!
>
>
>
>
>
<3 <3 <3 <3 <3

===== first 10 percent of evolutionary-dynamics.txt =====
IN 1831, at the age of twenty-two, Charles Darwin embarked on his journey around the world. He gazed at the breath-taking diversity of tropical flora and fauna, collected creepy-crawlies from the vast oceans that he traversed, was hopelessly seasick, saw slavery in Brazil, witnessed genocide in Argentina, and was underwhelmed by the naked humanity at Tierra del Fuego. He experienced the effects of a devastating earthquake in Chile that raised the South American continent. He led an expedition into the Andes and discovered marine fossils at high altitude. He paid little attention to which finches came from which islands in the Galápagos and ate most of the delicious turtles he had gathered on his way home across the Pacific. He saw Tahiti and the economic rise of Australia. He visited John Hershel, England’s leading physicist of the time, in South Africa; Hershel told him that “the mystery of mysteries” was the as yet unknown mechanism that gave rise to new species. Darwin returned to England’s shores after five years, having collected six thousand specimens that would require decades of analysis by an army of experts. His own observations in geology and the theory of his mentor, Sir Charles Lyell, that mountains were not lifted up in one day, but rose slowly over unimaginable periods of time, led Darwin to a key idea: given enough time everything can happen. Charles Darwin did not invent the concept of evolution. When he was a student in Edinburgh in the late 1820s, evolution was already the talk of the town. But evolution was rejected by the establishment. Those who adhered to evolutionary thinking were called Lamarckists, after the French scientist Jean-Baptiste Lamarck, who was the first to propose that species are not static, but change over time and give rise to new species. Lamarck had offered this perspective in a book published in 1809. He did not, however, propose a correct mechanism for how species change into each other. This mechanism was discovered first by Charles Darwin and independently by Alfred Russel Wallace. From reading the economist Thomas Malthus, Darwin was aware of the consequences of exponentially growing populations. Once resources become limiting only a fraction of individuals can survive. Darwin was also a keen observer of animal breeders. He analyzed their methods and studied their results. Slowly he understood that nature acted like a gigantic breeder. This was the first time that natural selection materialized as an idea, a scientific concept in a human mind. Darwin was thirty-three years old. The one problem that Darwin did not solve concerned the mechanism that could maintain enough diversity in a population for natural selection to operate. Darwin was unaware of the Austrian monk and botanist Gregor Mendel and his experiments on plant heredity. Mendel’s work had already been published but was hidden, gathering dust in the Annals of the Brno Academy of Sciences. Darwin once remarked, “I have deeply regretted that I did not proceed far enough at least to understand something of the great leading principles of mathematics; for men thus endowed seem to have an extra sense.” The engineer Fleeming Jenkins, who reviewed Darwin’s On the Origin of Species, published in 1859, had raised a fundamental and seemingly intractable objection to Darwin’s theory: if offspring inherit a blend of the parents’ characteristics, then variability diminishes in successive generations. Several decades later a simple mathematical equation, independently found by the famous British mathematician G. H. Hardy and the German physician Wilhelm Weinberg, showed that Mendelian (particulate) inheritance does lead to a maintainance of genetic diversity under random mating. The Hardy-Weinberg law is one of the fundamental principles of evolution under sexual reproduction. Mendelian genetics and Darwinian evolution were unified in the new discipline of mathematical biology, which developed from the seminal investigations of Ronald Fisher, J. B. S. Haldane, and Sewall Wright in the 1920s and 1930s. Through their work, fundamental concepts of evolution, selection, and mutation were embedded in a precise mathematical framework. This line of mathematical analysis was taken up in the 1950s by Motoo Kimura, who formulated the neutral theory of evolution. Kimura realized that most genetic mutations do not affect fitness and are fixed in populations only by random drift. Other milestones of evolutionary dynamics include William Hamilton’s discovery in 1964 that selection of “selfish genes” can favor altruistic behavior among relatives and John Maynard Smith’s invention of evolutionary game theory in 1973. In the mid-1970s Robert May revolutionized the mathematical approaches to ecology and epidemiology. Manfred Eigen and Peter Schuster formulated quasispecies theory, which provides a link between genetic evolution, physical chemistry, and information theory. Peter Taylor, Josef Hofbauer, and Karl Sigmund studied the replicator equation, the foundation of evolutionary game dynamics. This very brief and incomplete account of the evolution of evolutionary dynamics brings us to the present book. It has fourteen chapters. Although there is some progression of complexity, the chapters are largely independent. Therefore, if you know something about the subject, you can read the book in whatever order you like. My aim has been to keep things as simple as possible, as linear as possible, and as deterministic as possible. I will start with the basics and in a few steps lead you to some of the most interesting and unanswered research questions in the field. Having read the book, you will know what you need to embark on your own journey and make your own discoveries. This book represents an introduction to certain aspects of mathematical biology, but it is not comprehensive. Mathematical biology includes many topics, such as theoretical ecology, population genetics, epidemiology, theoretical immunology, protein folding, genetic regulatory networks, neural networks, genomic analysis, and pattern formation. The field is too diverse for any one book to represent it without running the risk of becoming as entertaining as a telephone directory. I have chosen those topics that I know well and where my explanation can be brief and effective. I have concentrated on evolution because it is the one unifying principle of all of biology. It might seem surprising that a book on evolutionary dynamics is not primarily about population genetics. Nevertheless the ideas and concepts of this fascinating field stand behind many of my explorations: the basic mathematical formulations of selection, mutation, random drift, fitness landscapes, and frequency-dependent selection as well as of evolution in structured populations have originated in population genetics. Several major themes of population genetics, however, such as sexual reproduction, sexual selection, recombination, and speciation, are not discussed here. In contrast, classical population genetics does not deal with evolutionary dynamics of infectious agents, the somatic evolution of cancer, evolutionary game theory, or the evolution of human language, all of which are subjects that I do explore. The main ingredients of evolutionary dynamics are reproduction, mutation, selection, random drift, and spatial movement. Always keep in mind that the population is the fundamental basis of any evolution. Individuals, genes, or ideas can change over time, but only populations evolve. The structure of the book is as follows. After this introduction, in Chapter 2 I will discuss populations of reproducing individuals and the basic ideas of natural selection and mutation. Simple models of population dynamics can lead to an exponential explosion, to a stable equilibrium, or to oscillations and chaos. Selection emerges whenever two or more individuals reproduce at different rates. Mutation means that one type can change into another. There are models of population growth that lead to the survival of whoever reproduces fastest (“survival of the fittest”). Other models lead to the survival of the first or the coexistence of all. In Chapter 3, quasispecies theory is introduced. Quasispecies are populations of reproducing genomes subject to mutation and selection. They live in sequence space and move over fitness landscapes. An important relationship between mutation rates and genome length is called the “error threshold”: adaptation on most fitness landscapes is possible only if the mutation rate per base is less than one over the genome length, measured in bases. In Chapter 4, we study evolutionary game dynamics, which arise whenever the fitness of an individual is not constant but depends on the relative abundance (= frequency) of others in the population. Thus evolutionary game theory is the most comprehensive way to look at the world. People who do not engage in evolutionary game theory restrict themselves to the rigidity of constant selection, where the fitness of one individual does not depend on others. The replicator equation is a nonlinear differential equation that describes frequency-dependent selection among a fixed number of strategies. We will encounter the Nash equilibrium and evolutionarily stable strategies. Evolutionary game theory and ecology are linked in an important way: the replicator equation is equivalent to the Lotka-Volterra equation of ecological systems, which describes the interation between predator and prey species. Chapter 5 is dedicated to the best game in town, the Prisoner’s Dilemma. The cooperation of reproducing entities is essential for evolutionary progress. Genes cooperate to form a genome. Cells cooperate to produce multicellular organisms. Individuals cooperate to form groups and societies. The emergence of human culture is a cooperative enterprise. The very problem of how to obtain cooperation by natural selection is described by the Prisoner’s Dilemma. In the absence of any other assumption, natural selection favors defectors over cooperators. Cooperation has a chance, however, if there are repeated interactions between the same two individuals. We will encounter the strategy Tit-for-tat, which is defeated first by Generous Tit-for-tat and then by Win-stay, lose-shift. In Chapter 6 we move to a stochastic description of finite populations. Neutral drift is a crucial aspect of evolutionary dynamics: if a finite population consists of two types of individuals, red and blue, and if both individuals have identical fitness, then eventually the population will be either all red or all blue. Even in the absence of selection, coexistence is not possible. If there is a fitness difference, then the fitter type has a greater chance of winning, but no certainty. We calculate the probability that the descendants of one individual will take over the whole population. This so-called fixation probability is important for estimating the rate of evolution. Chapter 7 is about games in finite populations. Most of evolutionary game theory has been formulated in terms of deterministic dynamics describing the limit of infinitely large populations. Here we move game theory to finite populations and make surprising observations. Neither a Nash equilibrium, nor an evolutionarily stable strategy, nor a risk-dominant strategy is protected by natural selection. There can be advantageous mutants against all three. In a bistable situation between two strategies, there is a simple “1/3 rule” that determines whether a strategy is favored by natural selection. In Chapter 8, the individuals of a population are represented by the vertices of a graph. The edges of the graph specify who interacts with whom. The graph can denote spatial relationships or social networks. The first observations of “evolutionary graph theory” are reported. The classical homogeneous population is defined by the complete graph, where all vertices are connected. We will see that circulations have the same evolutionary behavior as the complete graph in terms of fixation probability under constant selection, and therefore represent a particular balance between drift and selection. Graphs that enhance drift act as suppressors of selection. Graphs that reduce drift act as amplifiers of selection. In the limit of large population size, there exist graphs that guarantee the fixation of any advantageous mutant and the extinction of any disadvantageous mutant. Games on graphs are also studied in this chapter. There is a remarkably simple rule for the evolution of cooperation. Chapter 9 gives an account of evolutionary game dynamics on spatial grids. The primary approach will be deterministic, discrete in time, and discrete in space. This approach brings together game theory and cellular automata. We will observe evolutionary kaleidoscopes, dynamic fractals, and spatial chaos. There is all the complexity one could ever wish for—making it unnecessary for God to play dice. Moreover, cooperation can evolve on spatial grids. This is the concept of “spatial reciprocity.” In Chapter 10, we study the evolutionary dynamics of virus infections. I will argue that the mechanism of disease progression caused by the human immunodeficiency virus (HIV) is an evolutionary one. The immune system constantly attacks the virus, but the virus continuously evolves away, appears elsewhere in sequence space, and eventually overpowers the immune system. The resulting “diversity threshold theory” can explain why people succumb to the fatal immunodeficiency disease AIDS after a long and variable infection with HIV. Chapter 11 discusses the evolution of infectious agents, their attempts to infect new hosts, and the selection pressures that determine the level of virulence. The conventional wisdom is that well-adapted parasites are harmless to their hosts. This perspective is revised in the context of evolutionary dynamics. Competition between different mutants of a parasite maximizes its basic reproductive ratio. Superinfection takes into account that parasites compete on two levels of selection: within an infected host and in the population of hosts. Superinfection holds many surprising aspects, including the shortsighted evolution of higher and higher virulence beyond what would be optimum for the parasite. Chapter 12 explores the evolutionary dynamics of human cancer. Cancer arises when cooperation among cells breaks down. The mutated cells revert to their primitive program of uncontrolled replication. We calculate the rate of activation of oncogenes and inactivation of tumor suppressor genes. We analyze the impact of mutations that trigger “genetic instability.” We outline the conditions necessary for “chromosomal instability” to initiate cancer progression. Chapter 13 is devoted to the evolutionary dynamics of the one trait that is truly our own invention and that is arguably the one interesting thing that has happened in the last six hundred million years on earth. Bacteria invented all the biochemistry of life. Eukaryotes invented some advanced genetics and how to build complicated multicellular plants and animals. Humans will be remembered for language. Chapter 14 summarizes and concludes. Further readings will be found at the back of the book.
IN 1831, at the age of twenty-two, Charles Darwin embarked on his journey around the world. He gazed at the breath-taking diversity of tropical flora and fauna, collected creepy-crawlies from the vast oceans that he traversed, was hopelessly seasick, saw slavery in Brazil, witnessed genocide in Argentina, and was underwhelmed by the naked humanity at Tierra del Fuego. He experienced the effects of a devastating earthquake in Chile that raised the South American continent. He led an expedition into the Andes and discovered marine fossils at high altitude. He paid little attention to which finches came from which islands in the Galápagos and ate most of the delicious turtles he had gathered on his way home across the Pacific. He saw Tahiti and the economic rise of Australia. He visited John Hershel, England’s leading physicist of the time, in South Africa; Hershel told him that “the mystery of mysteries” was the as yet unknown mechanism that gave rise to new species. Darwin returned to England’s shores after five years, having collected six thousand specimens that would require decades of analysis by an army of experts. His own observations in geology and the theory of his mentor, Sir Charles Lyell, that mountains were not lifted up in one day, but rose slowly over unimaginable periods of time, led Darwin to a key idea: given enough time everything can happen. Charles Darwin did not invent the concept of evolution. When he was a student in Edinburgh in the late 1820s, evolution was already the talk of the town. But evolution was rejected by the establishment. Those who adhered to evolutionary thinking were called Lamarckists, after the French scientist Jean-Baptiste Lamarck, who was the first to propose that species are not static, but change over time and give rise to new species. Lamarck had offered this perspective in a book published in 1809. He did not, however, propose a correct mechanism for how species change into each other. This mechanism was discovered first by Charles Darwin and independently by Alfred Russel Wallace. From reading the economist Thomas Malthus, Darwin was aware of the consequences of exponentially growing populations. Once resources become limiting only a fraction of individuals can survive. Darwin was also a keen observer of animal breeders. He analyzed their methods and studied their results. Slowly he understood that nature acted like a gigantic breeder. This was the first time that natural selection materialized as an idea, a scientific concept in a human mind. Darwin was thirty-three years old. The one problem that Darwin did not solve concerned the mechanism that could maintain enough diversity in a population for natural selection to operate. Darwin was unaware of the Austrian monk and botanist Gregor Mendel and his experiments on plant heredity. Mendel’s work had already been published but was hidden, gathering dust in the Annals of the Brno Academy of Sciences. Darwin once remarked, “I have deeply regretted that I did not proceed far enough at least to understand something of the great leading principles of mathematics; for men thus endowed seem to have an extra sense.” The engineer Fleeming Jenkins, who reviewed Darwin’s On the Origin of Species, published in 1859, had raised a fundamental and seemingly intractable objection to Darwin’s theory: if offspring inherit a blend of the parents’ characteristics, then variability diminishes in successive generations. Several decades later a simple mathematical equation, independently found by the famous British mathematician G. H. Hardy and the German physician Wilhelm Weinberg, showed that Mendelian (particulate) inheritance does lead to a maintainance of genetic diversity under random mating. The Hardy-Weinberg law is one of the fundamental principles of evolution under sexual reproduction. Mendelian genetics and Darwinian evolution were unified in the new discipline of mathematical biology, which developed from the seminal investigations of Ronald Fisher, J. B. S. Haldane, and Sewall Wright in the 1920s and 1930s. Through their work, fundamental concepts of evolution, selection, and mutation were embedded in a precise mathematical framework. This line of mathematical analysis was taken up in the 1950s by Motoo Kimura, who formulated the neutral theory of evolution. Kimura realized that most genetic mutations do not affect fitness and are fixed in populations only by random drift. Other milestones of evolutionary dynamics include William Hamilton’s discovery in 1964 that selection of “selfish genes” can favor altruistic behavior among relatives and John Maynard Smith’s invention of evolutionary game theory in 1973. In the mid-1970s Robert May revolutionized the mathematical approaches to ecology and epidemiology. Manfred Eigen and Peter Schuster formulated quasispecies theory, which provides a link between genetic evolution, physical chemistry, and information theory. Peter Taylor, Josef Hofbauer, and Karl Sigmund studied the replicator equation, the foundation of evolutionary game dynamics. This very brief and incomplete account of the evolution of evolutionary dynamics brings us to the present book. It has fourteen chapters. Although there is some progression of complexity, the chapters are largely independent. Therefore, if you know something about the subject, you can read the book in whatever order you like. My aim has been to keep things as simple as possible, as linear as possible, and as deterministic as possible. I will start with the basics and in a few steps lead you to some of the most interesting and unanswered research questions in the field. Having read the book, you will know what you need to embark on your own journey and make your own discoveries. This book represents an introduction to certain aspects of mathematical biology, but it is not comprehensive. Mathematical biology includes many topics, such as theoretical ecology, population genetics, epidemiology, theoretical immunology, protein folding, genetic regulatory networks, neural networks, genomic analysis, and pattern formation. The field is too diverse for any one book to represent it without running the risk of becoming as entertaining as a telephone directory. I have chosen those topics that I know well and where my explanation can be brief and effective. I have concentrated on evolution because it is the one unifying principle of all of biology. It might seem surprising that a book on evolutionary dynamics is not primarily about population genetics. Nevertheless the ideas and concepts of this fascinating field stand behind many of my explorations: the basic mathematical formulations of selection, mutation, random drift, fitness landscapes, and frequency-dependent selection as well as of evolution in structured populations have originated in population genetics. Several major themes of population genetics, however, such as sexual reproduction, sexual selection, recombination, and speciation, are not discussed here. In contrast, classical population genetics does not deal with evolutionary dynamics of infectious agents, the somatic evolution of cancer, evolutionary game theory, or the evolution of human language, all of which are subjects that I do explore. The main ingredients of evolutionary dynamics are reproduction, mutation, selection, random drift, and spatial movement. Always keep in mind that the population is the fundamental basis of any evolution. Individuals, genes, or ideas can change over time, but only populations evolve. The structure of the book is as follows. After this introduction, in Chapter 2 I will discuss populations of reproducing individuals and the basic ideas of natural selection and mutation. Simple models of population dynamics can lead to an exponential explosion, to a stable equilibrium, or to oscillations and chaos. Selection emerges whenever two or more individuals reproduce at different rates. Mutation means that one type can change into another. There are models of population growth that lead to the survival of whoever reproduces fastest (“survival of the fittest”). Other models lead to the survival of the first or the coexistence of all. In Chapter 3, quasispecies theory is introduced. Quasispecies are populations of reproducing genomes subject to mutation and selection. They live in sequence space and move over fitness landscapes. An important relationship between mutation rates and genome length is called the “error threshold”: adaptation on most fitness landscapes is possible only if the mutation rate per base is less than one over the genome length, measured in bases. In Chapter 4, we study evolutionary game dynamics, which arise whenever the fitness of an individual is not constant but depends on the relative abundance (= frequency) of others in the population. Thus evolutionary game theory is the most comprehensive way to look at the world. People who do not engage in evolutionary game theory restrict themselves to the rigidity of constant selection, where the fitness of one individual does not depend on others. The replicator equation is a nonlinear differential equation that describes frequency-dependent selection among a fixed number of strategies. We will encounter the Nash equilibrium and evolutionarily stable strategies. Evolutionary game theory and ecology are linked in an important way: the replicator equation is equivalent to the Lotka-Volterra equation of ecological systems, which describes the interation between predator and prey species. Chapter 5 is dedicated to the best game in town, the Prisoner’s Dilemma. The cooperation of reproducing entities is essential for evolutionary progress. Genes cooperate to form a genome. Cells cooperate to produce multicellular organisms. Individuals cooperate to form groups and societies. The emergence of human culture is a cooperative enterprise. The very problem of how to obtain cooperation by natural selection is described by the Prisoner’s Dilemma. In the absence of any other assumption, natural selection favors defectors over cooperators. Cooperation has a chance, however, if there are repeated interactions between the same two individuals. We will encounter the strategy Tit-for-tat, which is defeated first by Generous Tit-for-tat and then by Win-stay, lose-shift. In Chapter 6 we move to a stochastic description of finite populations. Neutral drift is a crucial aspect of evolutionary dynamics: if a finite population consists of two types of individuals, red and blue, and if both individuals have identical fitness, then eventually the population will be either all red or all blue. Even in the absence of selection, coexistence is not possible. If there is a fitness difference, then the fitter type has a greater chance of winning, but no certainty. We calculate the probability that the descendants of one individual will take over the whole population. This so-called fixation probability is important for estimating the rate of evolution. Chapter 7 is about games in finite populations. Most of evolutionary game theory has been formulated in terms of deterministic dynamics describing the limit of infinitely large populations. Here we move game theory to finite populations and make surprising observations. Neither a Nash equilibrium, nor an evolutionarily stable strategy, nor a risk-dominant strategy is protected by natural selection. There can be advantageous mutants against all three. In a bistable situation between two strategies, there is a simple “1/3 rule” that determines whether a strategy is favored by natural selection. In Chapter 8, the individuals of a population are represented by the vertices of a graph. The edges of the graph specify who interacts with whom. The graph can denote spatial relationships or social networks. The first observations of “evolutionary graph theory” are reported. The classical homogeneous population is defined by the complete graph, where all vertices are connected. We will see that circulations have the same evolutionary behavior as the complete graph in terms of fixation probability under constant selection, and therefore represent a particular balance between drift and selection. Graphs that enhance drift act as suppressors of selection. Graphs that reduce drift act as amplifiers of selection. In the limit of large population size, there exist graphs that guarantee the fixation of any advantageous mutant and the extinction of any disadvantageous mutant. Games on graphs are also studied in this chapter. There is a remarkably simple rule for the evolution of cooperation. Chapter 9 gives an account of evolutionary game dynamics on spatial grids. The primary approach will be deterministic, discrete in time, and discrete in space. This approach brings together game theory and cellular automata. We will observe evolutionary kaleidoscopes, dynamic fractals, and spatial chaos. There is all the complexity one could ever wish for—making it unnecessary for God to play dice. Moreover, cooperation can evolve on spatial grids. This is the concept of “spatial reciprocity.” In Chapter 10, we study the evolutionary dynamics of virus infections. I will argue that the mechanism of disease progression caused by the human immunodeficiency virus (HIV) is an evolutionary one. The immune system constantly attacks the virus, but the virus continuously evolves away, appears elsewhere in sequence space, and eventually overpowers the immune system. The resulting “diversity threshold theory” can explain why people succumb to the fatal immunodeficiency disease AIDS after a long and variable infection with HIV. Chapter 11 discusses the evolution of infectious agents, their attempts to infect new hosts, and the selection pressures that determine the level of virulence. The conventional wisdom is that well-adapted parasites are harmless to their hosts. This perspective is revised in the context of evolutionary dynamics. Competition between different mutants of a parasite maximizes its basic reproductive ratio. Superinfection takes into account that parasites compete on two levels of selection: within an infected host and in the population of hosts. Superinfection holds many surprising aspects, including the shortsighted evolution of higher and higher virulence beyond what would be optimum for the parasite. Chapter 12 explores the evolutionary dynamics of human cancer. Cancer arises when cooperation among cells breaks down. The mutated cells revert to their primitive program of uncontrolled replication. We calculate the rate of activation of oncogenes and inactivation of tumor suppressor genes. We analyze the impact of mutations that trigger “genetic instability.” We outline the conditions necessary for “chromosomal instability” to initiate cancer progression. Chapter 13 is devoted to the evolutionary dynamics of the one trait that is truly our own invention and that is arguably the one interesting thing that has happened in the last six hundred million years on earth. Bacteria invented all the biochemistry of life. Eukaryotes invented some advanced genetics and how to build complicated multicellular plants and animals. Humans will be remembered for language. Chapter 14 summarizes and concludes. Further readings will be found at the back of the book.

THIS CHAPTER introduces three basic building blocks of evolutionary dynamics: replication, selection, and mutation. These are the fundamental and defining principles of biological systems. They apply to any biological organization anywhere in our or other universes and do not depend on the particular details of which chemistry was recruited to embody life. Any living organism has arisen and is continually modified by these three principles. Evolution requires populations of reproducing individuals. In the right environment, biological entities, such as viruses, cells, and multicellular organisms can make copies of themselves. The blueprint that determines their structure, the genomic material in form of DNA or RNA, is replicated and passed on to the offspring. Selection results when different types of individuals compete with each other. One type may reproduce faster and thereby outcompete the others. Reproduction is not perfect, but involves occasional mistakes, or mutations. Mutation is responsible for generating different types that can be evaluated in the selection process, and thus results in biological novelty and diversity. Selection will choose to maintain some innovations and dismiss others, and can favor or oppose genetic diversity. At the end of this chapter we will focus on the Hardy-Weinberg law of random mating. This discussion will be our only venture into the mathematics of sexual reproduction. In subsequent chapters we will encounter additional principles of evolutionary dynamics, such as random drift and spatial movement. 2.1 REPRODUCTION Imagine a single bacterial cell in a perfect environment that contains all the nutrients required for growth and happiness. In this bacterial heaven, the fortunate cell and all its offspring divide every 20 minutes, which is the known world record for bacterial cell division in an ideal lab setting. After 20 minutes the cell has given rise to 2 daughter cells. After 40 minutes there are 4 granddaughters, and after one hour there are 8 great granddaughters. How many cells will there be after three days? After t generations there are 2t cells. In three days there are 216 generations. Hence we expect 2216 = 1065 cells. The total mass of these cells would exceed the mass of the earth by many orders of magnitude. The growth law for this overwhelming expansion can be written as a recursive equation Here xt is the number of cells at time t, and xt+1 is the number of cells at time t + 1. The equation means that at time t + 1 there are twice as many cells as at time t. Time is measured in numbers of generations. The number of cells at time 0 is given by x0. With this initial condition, the solution of equation (2.1) can be written as Equation (2.1) is a so-called difference equation, because time is measured in discrete steps. We can also formulate a differential equation for exponential growth that measures time as a continuous quantity. Let x(t) denote the abundance of cells at time t. Suppose that cells divide at rate r. More precisely, we assume that the time for cell division follows an exponential distribution with average 1/r. We can write the differential equation Throughout this book, I will use the standard notation to refer to differentiation (of x) with respect to time. If the abundance of cells at time 0 is given by x0 then the solution of the differential equation (2.3) is Let us reconsider our bacterial supernova. If we measure time in units of days, then r = 72 means that the time for a cell cycle requires, on average, 20 minutes (calculated by dividing the total number of minutes in a day, 1,440, by 72). Hence there are 72 cell divisions in one day. After three days, one bacterial cell has generated e216 cells which is approximately 6 × 1093 cells. The discrepancy between the differential equation and the difference equation is a consequence of the varying assumptions for the distribution of the generation time. The difference equation assumes that each cell division occurs after exactly 20 minutes. The differential equation assumes that each cell division occurs after a time which is exponentially distributed around an average of 20 minutes. The exponential distribution is defined as follows: the probability that cell division occurs between time 0 and τ is given by 1 − e−rτ. On average, cells divide after 1/r time units. So far we have ignored cell death. Let us now suppose that cells die at rate d, which means that they have an exponentially distributed lifespan with an average of 1/d. The differential equation becomes The effective growth rate is the difference between the birth rate, r, and the death rate, d. If r > d, then the population will expand indefinitely. If r < d, then the population will converge to zero and become extinct. If r = d, then the population size remains constant, but this situation is unstable: small deviations from absolute equality between birth and death will lead to either exponential expansion or decline. It is important to note that setting r = d in equation (2.5) does not constitute a mechanism for maintaining a stable constant population size. The simple equation (2.5) allows us to introduce an extremely important concept in evolution, ecology and epidemiology: the basic reproductive ratio, r/d. This ratio denotes the expected number of offspring that come from any one individual. The average lifetime of a cell is 1/d. The rate of producing offspring cells is given by r. If each cell produces on average more than one offspring, r/d > 1, then an exponential expansion will follow. A basic reproductive ratio greater than one is a necessary condition for population expansion. We have observed that ongoing exponential growth can lead to unreasonably high numbers in a very short time. In a realistic environment, the expanding population will hit constraints that prevent further expansion. For example, the population might run out of nutrients or physical space. A model for population expansion with a maximum carrying capacity is given by the logistic equation As before, the parameter r refers to the rate of reproduction in the absence of density regulation, when the population size, x, is much smaller than the carrying capacity K. As x increases, the rate of growth slows down. When x reaches the carrying capacity, K, then the population expansion ceases. For the initial condition x0, the solution of equation (2.6) is given by In the limit of infinite time, t → ∞, the population size converges to the equilibrium x* = K. Throughout the book we will use a superscript asterisk to denote a quantity at equilibrium. 2.1.1 Deterministic Chaos We can also study a logistic difference equation. Without loss of generality, let us rescale the population abundance in such a way that the maximum carrying capacity is given by K = 1. We have Note that the growth rate in the difference equation, a, is analogous to 1 + r in the differential equation (2.6). In contrast to the differential equation, the logistic difference equation (2.8) has many surprises. The behavior of this equation is so rich that many papers and even books have been written about it, and it has generously awarded glorious careers to some scientists who have studied it. The abundance of the population, x, is given by a number between 0 and 1. Thegrowthrate, a, can vary between 0 and 4. If a < 0 or a > 4, then negative x values will be generated, which are not biologically meaningful. The point x = 0 is always an equilibrium. If a < 1, then the only stable equilibrium of the system is given by x* = 0. This means the population will die out. If 1 < a < 3, then the only stable equilibrium is given by x* = (a − 1)/a. All trajectories starting from any initial condition x0 (greater than 0 and less than 1) will converge to this value. The point x* is a global attractor for the open interval (0, 1). If a > 3, then the point x* becomes unstable. For a values slightly above 3, we find a stable oscillation of period two. As a increases, the period two oscillator is replaced by period four, then by eight, and so on. For a = 3.57 there are infinitely many even periods. For a = 3.6786 the first odd periods appear. For 3.82 < a ≤ 4 all periods occur. The logistic map with a = 4 is a simple and most illuminating example for studying deterministic chaos. For any value xt it is straightforward to compute the population size in the subsequent generation, xt+1. Yet the dynamics are unpredictable in the following sense. Suppose the value of xt is only known subject to a small uncertainty. It may not be clear whether xt = 0.3156 or 0.3157. After ten generations, however, the trajectories starting from these two initial values will have diverged completely. Hence prediction is impossible. Anything can happen.
We conclude that simple rules can generate complicated behavior. Much of the apparent complexity and unpredictability of biological time series, such as the population size of birds in a particular habitat, the number of measles cases in New York City, or the price fluctuations of stocks and bonds, could in principle be the consequence of deterministic laws. Figure 2.1 Evolution requires a population of reproducing individuals. Strictly speaking, neither genes, nor cells, nor organisms, nor ideas evolve. Only populations can evolve. 2.2 SELECTION Selection operates whenever different types of individuals reproduce at different rates. At the very least we need two types (Figure 2.1). Let us call them A and B. Type A individuals reproduce at rate a. Type B individuals reproduce at rate b. The rate of reproduction is interpreted as fitness. Therefore the fitness of A is a, the fitness of B is b. Denote by x(t) the number of A individuals at time t. Denoteby y(t) the number of B individuals at time t. At time t = 0, the numbers of A and B are respectively given by x0 and y0. The A and B subpopulations grow according to the differential equations Equation (2.9) is a system of two ordinary, linear differential equations. The analytical solution is given by Hence the A and B subpopulations grow exponentially at rates a and b, respectively. The doubling time for A is log 2/a. The doubling time for B is log 2/b. If a is greater than b, then A reproduces faster than B: after some time, there will be more A than B individuals. Denote by ρ(t) = x(t)/y(t) the ratio of A over B at time t. We have The solution of this differential equation, for the initial condition ρ0 = x0/y0, is given by Hence if a > b then ρ tends to infinity. In this case A will outcompete B, which means selection favors A over B. If, on the other hand, a < b, then ρ tends to zero. In this case B will outcompete A, which means that selection favors B over A. Let us now consider a situation in which the total population size is held constant. This situation can arise, for example, when an ecosystem has a constant maximum carrying capacity. Let x(t) denote the relative abundance of A at time t. Instead of “relative abundance” we can also say “frequency.” Let y(t) denote the frequency of B. Since there are only A and B individuals in the population, we have x + y = 1. As before, A and B individuals reproduce, respectively, at rates a and b. We have the system of equations The term ϕ ensures that x + y = 1. This is only possible if ϕ = ax + by. Observe that ϕ is the average fitness of the population. The system (2.13) describes only a single differential equation, because y can be replaced by 1 − x. We obtain
Figure 2.2 Selection arises if two types, A and B, have different rates of reproduction, a and b. If A reproduces faster than B, which means a > b, then A will become more abundant than B. Eventually A will take over the entire population; B will become extinct. Denote by x the relative abundance (= frequency) of type A. The quantity x is a number between 0 and 1. Therefore selection dynamics are defined on the closed interval [0, 1]. This differential equation has two equilibria, one for x = 0 and the other for x = 1. At these two points, we have = 0. This observation makes sense: if x = 1 then the system consists only of A individuals and nothing more can happen; if x = 0, then the system consists only of B individuals and again nothing more can happen. We can, however, make an additional observation. If a >b, then > 0 for all values of x that are strictly greater than 0 and strictly smaller than 1. This means that for any mixed system (consisting of some A and some B individuals) the fraction of A will increase if the fitness of A is greater than the fitness of B. In this case, the fraction of B will converge to 0, while the fraction of A converges to 1. We have encountered the concept of “survival of the fitter” (Figure 2.2). 2.2.1 Survival of the Fittest The model can be extended to describe selection among n different types. Let us label them i = 1,…, n. Denote by xi(t) the frequency of type i. The structure of the population is given by the vector Denote by fi the fitness of type i. As before, fitness is a non-negative real number and describes the rate of reproduction. The average fitness of the population is given by Figure 2.3 If the total population size is constant, then selection dynamics can be formulated in terms of relative abundance (= frequency). Suppose there are n different types, i = 1,…, n. Type i has frequency xi. The sum over all xi is one. The set of all points, (x1,…, xn) with the property , is called the simplex Sn. Selection dynamics occur on the simplex Sn. The figure shows S2, S3, and S4. The simplex Sn is an n − 1 dimensional structure embedded in an n-dimensional Euclidian space. The simplex Sn has n faces that each consist of the simplex Sn−1. Selection dynamics can be written as The frequency of type i increases, if its fitness exceeds the average fitness of the population. Otherwise it will decline. The total population size remains constant: and . The set of points with the property is called the simplex Sn (Figure 2.3). Each point in the simplex refers to a particular structure of the population. The interior of the simplex is the set of points with the property that xi > 0 for all i = 1,…, n. The face of the simplex is the set of points with the property that xi = 0 for at least one i. The vertices of the simplex are the corner points where exactly one type is present, xi = 1, while all other types are extinct, xj = 0 for all j ≠ i (Figures 2.4 and 2.5). Figure 2.4 The interior of a simplex is the set of all points where all coordinates are strictly positive; this means no type has become extinct. The faces are the sets of points where at least one coordinate is zero; this means at least one type has become extinct. The vertices describe pure populations, where all but one type have become extinct. The simplex S2 is given by the closed interval [0, 1]. The notation [0, 1] refers to all numbers which are greater than or equal to 0 and less than or equal to 1. In contrast, (0, 1) is the open interval; it contains all numbers that are strictly greater than 0 and strictly less than 1. The open interval (0, 1) is the interior of the closed interval [0, 1] and, therefore, is also the interior of the simplex S2. Equation (2.16) contains a single globally stable equilibrium. Starting from any initial condition in the interior of the simplex, the population will converge to a corner point where all but one type have become extinct. The winner, k, enjoys a well-deserved victory because it has the property of having the largest fitness, fk. Thus fk > fi for all i = k. The system shows competitive exclusion: the fittest type will outcompete all others. This is the concept of “survival of the fittest.” 2.2.2 Survival of the First, Survival of All Let us return to the selection of two types, A and B, but without making the assumption that their growth rates are linear functions of their frequencies. Instead consider the equation
Figure 2.5 Five points on the simplex S3. In the center, (1/3, 1/3, 1/3), all three types have the same frequency. There are three faces. The center of one particular face is given by (0, 1/2, 1/2); one type has become extinct. The corner points (vertices) indicate populations that consist of only one type. S3 has three corners: (1, 0, 0),(0, 1, 0), and (0, 0, 1).
Figure 2.5 Five points on the simplex S3. In the center, (1/3, 1/3, 1/3), all three types have the same frequency. There are three faces. The center of one particular face is given by (0, 1/2, 1/2); one type has become extinct. The corner points (vertices) indicate populations that consist of only one type. S3 has three corners: (1, 0, 0),(0, 1, 0), and (0, 0, 1). As before, a and b denote the fitness values of A and B, respectively. If c = 1, we are back to equation (2.13). If c < 1, then growth is subexponential. In the absence of the density limitation, ϕ, the growth curve of the two types would be slower than exponential. In contrast, if c > 1, then growth is superexponential. In the absence of the density limitation, ϕ, the growth curve of the two types would be faster than exponential (hyperbolic). To maintain a constant population size, x + y = 1, we set ϕ = axc + byc. Equation (2.17) reduces to where Figure 2.6 Survival of all: for subexponential growth (c < 1), there is a stable mixed equilibrium between A and B, even if one type has a faster growth rate than the other. Survival of the first: for superexponential growth (c > 1), there is an unstable mixed equilibrium between A and B, while the pure populations are stable. For example, if the whole population consists of B, then A cannot invade even if it has a higher growth rate. This equation always has fixed points for x = 0 and x = 1. For c ≠ 1 there exists exactly one other fixed point between 0 and 1. It is given by If c < 1, then the boundary fixed points, x = 0 and x = 1, are always unstable; the interior fixed point, x*, is globally stable. Hence there is survival of both A and B. Surprisingly, even if A is fitter than B, a > b, then a small amount of B can invade an A population. If c > 1, then the boundary fixed points, x = 0 and x = 1, are always stable; the interior fixed point, x*, is unstable. If x > x*, then A will outcompete B. If x < x*, then B will outcompete A. Again this observation is remarkable. Even if A is fitter than B in the sense that a > b, a B population cannot be invaded by an A mutant. We conclude that superexponential growth favors whoever was there first (survival of the first) whereas subexponential growth leads to the survival of all (Figure 2.6). What is the intuition behind this observation? An extreme form of subexponential growth is “immigration,”c = 0. The growth rate does not depend on x or y at all. We have with ϕ = a + b. This equation can be interpreted as the immigration of A and B into the population from some other place. It is clear that these immigration dynamics lead to coexistence. A value of c between 0 and 1 is a mixture between immigration and linear growth and retains the property of coexistence. If c > 1, on the other hand, then A cannot invade B even if a > b. (“Invasion” means that an infinitesimally small fraction of A individuals can increase in abundance in a population where almost all individuals are of type B.) The intuitive explanation is as follows: we can think of the case c = 2 as implying that two individuals of the same type have to meet in order to reproduce. If there is only an infinitesimally small fraction of A individuals, then two A individuals will
never meet and hence A will not reproduce. If c = 3 then three individuals of the same type have to meet in order to reproduce. Again arbitrarily small fractions of a type can never increase. The same intuition holds for all values c > 1. The case c = 2 can also be interpreted as an evolutionary game between two strategies, A and B, that are strict Nash equilibria. Neither strategy can invade the other. We will encounter these concepts in Chapter 4. 2.3 MUTATION Life takes advantage of mistakes. Replication of DNA or RNA can lead to slightly modified sequences that represent novel variants. Errors during reproduction are called mutations. In this section, we study the simplest possible differential equations that describe mutation (Figure 2.7). Let us again consider just two types, A and B. Denote by u1 the mutation rate from A to B: u1 is the probability that the reproduction of A leads to B. Figure 2.7 Mutation can occur during reproduction: type A produces an offspring that is type B. Mutation can also occur in the absence of reproduction: type A changes into type B. Many genetic mutations occur when the genomic material of a cell is being copied. But mutagens can also change the genetic material of a cell when it is not dividing. Conversely, denote by u2 the mutation rate from B to A. As before, let x and y denote the frequencies of A and B, respectively. We have Since A and B have the same fitness (a = b = 1), the average fitness of the population is constant and given by ϕ = 1. Taking into account x + y = 1, system (2.22) reduces to the differential equation The frequency of A converges to the stable equilibrium Hence mutation leads to coexistence between A and B. The relative proportion of A and B at equilibrium depends on the mutation rates. At equilibrium, the ratio of A to B is given by x*/y* =u2/u1. If the mutation rates are the same, u1 = u2, and then x* = y*. Sometimes the mutation rate in one direction is much larger than in the other direction. In these cases, it often makes sense to ignore mutation in the other direction altogether. Let u2 = 0. We have Therefore the frequency of A declines over time as The frequency of B increases as If mutation occurs only from A to B but not the other way around, then A will die out and B will take over the whole population. We see that mutation can affect survival. Different mutation rates can introduce selection even in the absence of different reproductive rates. 2.3.1 Mutation Matrix We can extend mutation dynamics to n different types. Let us introduce the mutation matrix, Q = [qij]. The probability that type i mutates to type j is given by qij. Since each type i has to produce itself or some other type, we have Thus Q is a stochastic n × n matrix. A stochastic matrix is defined by the properties that (i) all entries are numbers from the interval [0, 1] (so-called probabilities), (ii) there are as many rows as columns, and (iii) the sum of each row is 1. Stochastic matrices always have 1 as an eigenvalue, and no eigenvalue has an absolute value greater than 1. Mutation dynamics can be written as In vector notation we can write Again the average fitness is just ϕ = 1. The equilibrium is given by the left-hand eigenvector associated with eigenvalue 1: The point denotes the unique globally stable equilibrium of the mutation dynamics. 2.4 MATING One of the problems that Charles Darwin could not solve was the following: under random mating and blending inheritance, the variability in a population should rapidly decline. Yet it was clear that variability was needed for natural selection. If variability disappears, then natural selection has nothing upon which to act. Suppose there is a distribution of body size in a population. If children inherit the average body size of their parents, then after some time everybody is the same size. Under these circumstances, how can natural selection affect changes in body size? The first part of the solution is that inheritance (on the level of genes) is not blending but particulate, as had been discovered by Gregor Mendel and published in 1866. That is, individuals have discrete genotypes that get reshuffled, not blended, during mating. Mendel’s work was unknown to Darwin. The second step was a simple mathematical analysis, which was performed by the British mathematician G. H. Hardy, who was proud never to have done anything useful (= applied) in his life, only to have his name forever associated with a highly useful and very applied concept in population genetics. Moreover, Hardy’s brief calculation was generalized by the German physician Wilhelm Weinberg. Consider an infinitely large population of a diploid organism with two sexes and random mating (a diploid organism has two copies of its genome; humans and many other animals are diploid). Let us look at one particular gene locus and assume there are two alleles, A1 and A2. The alleles are variants of the same gene and might differ in one or a few point mutations. (Point mutation means that only one single base of the DNA sequence is changed.) There are 3 different genotypes: A1A1, A1A2, A2A2. Let us denote their frequencies in the population by x, y, and z, respectively. Denote by p and q the frequencies of alleles A1 and A2. We have x + y + z = 1 and p + q = 1. Moreover,
Let us now assume random mating. In the next generation, the genotype frequencies are given by For the allele frequencies in the next generation we have again Combining (2.32) and (2.33), we observe that Therefore the allele frequencies remain unchanged from one generation to the next. Moreover, combining (2.32) and (2.34), we observe From the first generation on, the genotype frequencies can be directly derived from the allele frequencies. Note that equation (2.35) need not hold for the initial genotype and allele frequencies. The Hardy-Weinberg law (expressed by equations 2.34 and 2.35) can be generalized to n alleles. In summary, the Hardy-Weinberg law states that particulate inheritence preserves variation within a population under random mating. SUMMARY Evolution requires populations of reproducing individuals. Asexual reproduction leads to exponential population growth (which will eventually be checked by resource limitation). Simple models of population growth in discrete time can give rise to very complicated dynamics. Selection arises when different types of individuals reproduce at different rates. Normally, the faster-reproducing (fitter) individual outcompetes the slower reproducing (less fit) individual. If there are many different types, then selection dynamics can lead to “survival of the fittest.” All others become extinct. Sublinear growth rates lead to coexistence, “survival of all.” Superlinear growth rates prevent invasion of a new type and thereby lead to “survival of the first.” Mutation arises when reproduction is not perfectly accurate. Mutation promotes coexistence of different types. Asymmetric mutation can lead to selection even if all individuals have the same reproduction rate. The Hardy-Weinberg law states that random mating preserves genetic variation within a population.

GENOMES ARE SEQUENCES of the four-letter alphabet A, T, C, G, denoting the nucleotides adenine, thymine, cytosine, and guanine. All living cells use double-stranded DNA to carry their genomic information. Many viruses also use DNA, but some viruses encode their genome in form of RNA. The genome length of organisms varies greatly, ranging from about 104 nucleotides for small viruses, to 106 for bacteria to 3 × 109 for humans. Curiously, newts and lungfish “need” an even larger genome than do humans (19 × 109 and 140 × 109, respectively). The evolutionary dynamics of genome size and genome organization is a fascinating topic. If a cell wants to produce a particular protein, then the DNA of the corresponding gene is “transcribed” into messenger RNA (mRNA), which is in turn “translated” into protein. The transcription is done by particular enzymes called DNA-dependent RNA polymerases. The translation is performed by a complicated arrangement of RNA and proteins called ribosomes. The words “transcription” and “translation” were invented by the mathematician John von Neumann when he calculated how to build a self-reproducing machine. He came up with an architecture equivalent to the organization of cells some decades before molecular biology had been invented. RNA also uses a four-letter alphabet, A, U, C, G. Thymine is replaced by uracil. Furthermore, the sugar backbone of RNA has an additional -OH (hydroxy) group, which makes the molecule less stable and more dynamic. DNA is a stable carrier of information. RNA also carries information, but in addition some RNAs have enzymatic activity. Proteins consist of 20 amino acids. Each amino acid is encoded by a sequence of three letters of the RNA alphabet. This genetic code is essentially the same for all living cells, ranging from bacteria to humans to newts. Hence the genetic code is believed to have originated only once: in the first cell that is ancestor to all existing cells. A 4-letter alphabet generates 64 possible sequences of length 3. Since there are only 20 amino acids, the genetic code is redundant: some amino acids are encoded by more than one sequence. Some sequences are used to signal the end of the transcription process. We see that molecular biology adds a precise information-theoretic perspective to evolutionary dynamics. 3.1 SEQUENCE SPACE In the green hills of Sussex lived an imaginative theoretical biologist, John Maynard Smith, who once pictured all proteins (of a certain length) arranged in such a way that nearest neighbors differed by a single amino acid. This was the origin of what we call “sequence space” as a concept in the human mind. Let us consider all proteins of the modest length 100. Each position of the protein sequence is filled by one of 20 amino acids. Hence, this space has 100 dimensions and in total 20100 points. This number corresponds to 10130 proteins. In contrast, there are only some 1080 estimated protons in our universe. Nor is there any reason for us to consider only proteins of length 100; some proteins are much longer. We conclude there are many more possible proteins than available protons and hence evolution so far has and, for the remaining 1030 years that constitute the lifetime of our protons, will only explore a vanishingly small subset of all possible proteins. What is true of proteins is also true of genes and genomes. We can imagine all nucleotide sequences of a certain length arranged in a way that nearest neighbors differ in one position. For sequence length L this generates a lattice in an L-dimensional space. In each dimension there are 4 discrete possibilities. Hence there are 4L possible sequences. Figure 3.1 Genomes live in sequence space. The number of dimensions is given by the length of the genome. Small viruses live in 10,000 dimensions. Humans live in about 3 billion dimensions. For writing computer programs, it is often convenient to use binary sequences, the fundamental strings of silicon thoughts. Moreover, everything from Shakespeare to E. coli can be encoded in binary sequences. For length L there are 2L possibilities. In Figure 3.1, the binary sequence space for L = 3 is shown. The distance between 000 and 010 is one. The distance between 000 and 011 is 2 (and not ). Hence sequence space is characterized not by a Euclidean metric but by a so-called Hamming metric or Manhattan metric. In Manhattan, if you are on 5th Avenue and 51st Street it takes 2 blocks to go to 6th Avenue and 52nd Street, not blocks. This metric was introduced by Richard Hamming in information theory. Let us compare the binary sequence space of length L = 300 with a three-dimensional cubic lattice containing the same number of points. There are 2300 ≈ 1090 points. Imagine nearest neighbors are placed at a distance of 1 meter. The diagonal of the three dimensional cubic lattice has a length of about 1030 meters, which corresponds to about 1014 light years. In contrast, the longest distance in the L-dimensional hypercube is only 300 meters. Thus sequence space is characterized by short distances, but many dimensions. It is not far to move from one sequence to another, but there are many possible steps that lead in wrong directions. Evolution is a trajectory through sequence space. This trajectory needs an efficient guide.
Figure 3.2 The fitness landscape is a high-dimensional mountain range. Each genome (= each point in sequence space) gets assigned a fitness value. 3.2 FITNESS LANDSCAPES The American population geneticist Sewall Wright invented the concept of a “fitness landscape” in the 1930s, but Manfred Eigen and Peter Schuster, collaborating in the 1970s, combined fitness landscape with sequence space. Consider a function that assigns to each genomic sequence a fitness value. Hence we build a mountain range on the foundation of an L-dimensional sequence space (Figure 3.2). This mountain range has L + 1 dimensions. The evolutionary process of mutation and selection explores this hyper-alpine mountain range. The genomic sequence represents the genotype of an organism. The phenotype of an organism is given by its shape, behavior, performance and any kind of ecological interaction. The phenotype determines the fitness (reproductive rate) of the organism. There is a mapping from genotype to phenotype. There is another mapping from phenotype to fitness. The fitness landscape is a convolution of these two mappings. It is a direct mapping from genotype to fitness. Figure 3.3 The ensemble of genomes of a natural population form a quasispecies: the genomes of different individuals are similar but not identical. Biology has chosen a four-letter alphabet consisting of the nucleotides A, T, C, and G for its genes. Most in silico evolution uses a binary alphabet for convenience. Sequence differences (mutations) are shown in red. The fitness landscape of certain problems can be determined experimentally. For example, HIV can generate point mutations that confer drug resistance. The relative growth rate of such mutants can be determined by in-vitro assays. In general, however, to understand the relationship between genotype, phenotype, and fitness is an extremely complicated problem. Much of biology, including developmental biology, molecular biology, post-genomics, and proteomics, is devoted to this very task. 3.3 THE QUASISPECIES EQUATION A quasispecies is an ensemble of similar genomic sequences generated by a mutation-selection process (Figure 3.3). The term was introduced by the chemists Manfred Eigen and Peter Schuster. In chemistry the word “species” refers to an ensemble of identical molecules, for example, the species of all water molecules. But the species of all RNA molecules does not contain identical sequences, and therefore the term “quasispecies” was coined. Biologists are sometimes confused by this expression, because they relate it to the concept of a biological species. We stay with binary sequences for convenience. We note that any genomic or other information can be encoded by binary sequences. Consider all binary sequences of length L. Enumerate all those sequences by i = 0, 1, 2,…, n where n = 2L − 1. A natural enumeration is obtained if the sequence represents the binary description of the corresponding integer. For example, let L = 4. The sequence 0000 corresponds to i = 0, the sequence 0001 to i = 1, the sequence 0010 to i = 2,…, the sequence 1111 to i = 15. Imagine an infinitely large population of organisms, each carrying a genome of length L. Denote by xi the relative abundance (= frequency) of those organisms that contain genome i. We have The genomic structure of the population is given by the vector Denote by fi the fitness of genome i. It is a non-negative real number. Thus genomes of type i are being reproduced at rate fi. The fitness landscape is given by the vector The average fitness of the population, is the inner product of the vectors and . We have During replication of a genome, mistakes can happen. The probability that replication of genome i results in genome j is given by qij. Here we again meet the mutation matrix Q = [qij] of section 2.3. We remember that Q is a stochastic matrix: it has as many rows as columns; each entry is a probability, which means a number between 0 and 1; each row sums to one, The quasispecies equation (Figure 3.4) is given by Sequence i is obtained by replicating any sequence j at rate fj times the probability that replication of sequence j generates sequence i. Each sequence is removed at rate ϕ to ensure that the total population size remains constant, Thus quasispecies dynamics are defined on the simplex, Sn. In the limiting case of completely error-free replication, Q becomes the identity matrix: all diagonal entries are one, all off-diagonal entries are zero. Consider an initial condition in the interior of the simplex, defined by xi > 0 for all i. The quasispecies will converge to a homogeneous population that consists only of the fittest sequence. If f0 > fi for all i ≠ 0, then the stable equilibrium is given by x0 = 1 and xi = 0 for i ≠ 0. If there are no errors, then the quasispecies equation (3.1) reduces to the selection equation (2.16) of section 2.2.1. Figure 3.4 The quasispecies equation, formulated by Manfred Eigen and Peter Schuster, is one of the most important equations in theoretical biology. It describes the mutation and selection of an infinitely large population on a constant fitness landscape. Let us now assume that errors occur. This means that (at least some) off-diagonal entries of Q are not zero. In many realistic contexts, the matrix Q is irreducible, which means it is possible to find a sequence of mutations from any one genome i to any other genome j. Furthermore, let fi > 0 for at least some i. In this case, the quasispecies equation admits a single, globally stable equilibrium, , in the simplex Sn. The equilibrium quasispecies, , does not necessarily maximize the average fitness ϕ. Consider again a fitness landscape with the property f0 > fi for all i ≠ 0. Then the population consisting only of sequence 0 will have a higher fitness than the equilibrium population . Thus, mutations reduce the average fitness at equilibrium.


===== fisher_theorem.pdf =====
TREE 
vol. 
7, 
no. 
3, 
March 
7992 
Fisher
™
s 
Fundamental 
Theorem 
of 
Natural 
Selection 
Steven 
A. 
Frank 
and 
Montgomery 
Slatkin 
Fisher
™
s 
Fundamental 
Theorem 
of 
natural 
selection 
is 
one 
of 
the 
most 
widely 
cited 
theories 
in 
evolutionary 
6iology. 
Yet 
it 
has 
6een 
argued 
that 
the 
standard 
interpret- 
ation 
of 
the 
theorem 
is 
very 
different 
from 
what 
Fisher 
meant 
to 
sag. 
What 
Fisher 
really 
meant 
can 
6e 
illustrated 
6y 
look- 
ing 
in 
a 
new 
wag 
at 
a 
recent 
model 
for 
the 
evolution 
of 
clutch 
size. 
Why 
Fisher 
was 
misunderstood 
depends, 
in 
part, 
on 
the 
contrasting 
views 
of 
evolution 
promoted 
by 
Fisher 
and 
Wright. 
R.A. 
Fisher 
and 
Sewall 
Wright, 
two 
of 
the 
founders 
of 
modern 
evol- 
utionary 
theory, 
fought 
bitterly 
for 
30 
years. 
Angry 
words 
were 
exchanged 
on 
a 
variety 
of 
topics, 
but 
at 
the 
heart 
of 
the 
controversy 
was 
a 
clash 
between 
each 
scientist
™
s 
vision 
of 
natural 
selection 
and 
evolution: 
on 
one 
side, 
Fisher
™
s 
Fundamental 
Theorem 
of 
natural 
selection, 
and 
on 
the 
other 
side, 
Wright
™
s 
Adaptive 
Landscape. 
Fisher 
detested 
the 
Adaptive 
Landscape 
formulation 
of 
natural 
selection, 
an 
opinion 
that 
he 
re- 
peated 
on 
many 
occasions. 
Al- 
though 
Wright
™
s 
original 
formu- 
lation
™ 
of 
the 
Adaptive 
Landscape 
in 
1932 
is 
obscure2, 
the 
Adaptive 
Landscape 
soon 
came 
to 
mean 
that 
gene 
frequencies 
change 
as 
if 
pro- 
ceeding 
up 
a 
hill 
of 
increasing 
average 
fitness. 
Wright 
justified 
this 
metaphor 
by 
showing 
that 
under 
some 
conditions 
the 
rate 
of 
change 
in 
gene 
frequency 
depends 
on 
the 
steepness 
of 
the 
gradient 
in 
average 
fitness, 
dw/dq, 
where 
v 
is 
the 
average 
fitness 
of 
the 
population 
and 
q 
is 
gene 
frequency. 
Fisher 
objected 
to 
the 
idea 
that 
natural 
selection 
alone 
would 
have 
any 
simple 
effect 
on 
the 
average 
fitness 
of 
the 
population. 
For 
example: 
‚
In 
regard 
to 
selection 
theory, 
objection 
should 
be 
taken 
to 
Wright
™
s 
equation 
[the 
expression 
dwldql 
principally 
because 
it 
repre- 
sents 
natural 
selection, 
which 
in 
reality 
acts 
upon 
individuals, 
as 
Steven 
Frank 
is 
at 
the 
Dept 
of 
Ecology 
and 
Evol- 
utionary 
Biology, 
University 
of 
California, 
Irvine, 
CA 
92717, 
USA; 
Montgomery 
Slatkin 
is 
at 
the 
Dept 
of 
Integrative 
Biology, 
University 
of 
California, 
Berkeley, 
CA 
94720, 
USA. 
92 
though 
it 
were 
governed 
by 
the 
average 
condition 
of 
the 
species 
or 
inter-breeding 
group
™ 
(Ref. 
3, 
p. 
58). 
Fisher 
also 
pointed 
out 
that 
average 
fitness, 
measured 
by 
the 
intrinsic 
(malthusian) 
rate 
of 
in- 
crease 
of 
a 
species, 
must 
fluctuate 
about 
zero 
(Ref. 
4, 
pp. 
41-45). 
Otherwise, 
if 
a 
species
™ 
rate 
of 
increase 
were 
consistently 
positive, 
it 
would 
soon 
overrun 
the 
world, 
or 
if 
a 
species
™ 
rate 
of 
increase 
were 
consistently 
negative, 
it 
would 
quickly 
become 
extinct. 
These 
comments 
about 
average 
fitness, 
repeated 
in 
different 
ways 
by 
Fisher, 
seem 
to 
contradict 
his 
own 
proud 
claims 
for 
his 
Fundamen- 
tal 
Theorem 
of 
natural 
selection: 
‚
The 
rate 
of 
increase 
in 
fitness 
of 
any 
organism 
at 
any 
time 
is 
equal 
to 
its 
genetic 
variance 
in 
fitness 
at 
that 
time
™ 
(Ref. 
4, 
p. 
371, 
or 
‚
The 
rate 
of 
increase 
of 
fitness 
of 
any 
species 
is 
equal 
to 
its 
genetic 
variance 
in 
fitness
™ 
(Ref. 
4, 
p. 
501. 
If 
‚
fitness 
of 
any 
species
™ 
is 
inter- 
preted 
as 
‚
average 
fitness
™
, 
which 
is 
the 
usual 
interpretation, 
these 
statements 
certainly 
suggest 
that 
the 
average 
fitness 
of 
a 
species 
increases 
steadily 
over 
time, 
just 
as 
in 
Wright
™
s 
Adaptive 
Landscape. 
Everyone, 
including 
Wright, 
in- 
terpreted 
Fisher 
as 
saying 
that 
the 
Fundamental 
Theorem 
was 
about 
the 
average 
fitness 
of 
a 
species. 
In 
fact, 
Wright 
often 
quoted 
the 
Fun- 
damental 
Theorem 
in 
support 
of 
his 
gradient 
formulat& 
of 
the 
Adapt- 
ive 
Landscape, 
dwldq. 
As 
pointed 
out 
by 
Ewens5, 
Wright 
said 
in 
his 
last 
paper: 
‚
The 
effects 
Ion 
gene 
frequencies 
in 
an 
Adaptive 
Landscape] 
may 
be 
calculated 
using 
Fisher
™
s 
fundamental 
theorem 
of 
natural 
selection
™ 
(Ref. 
6, 
p. 
I 
181, 
in 
spite 
of 
the 
fact 
that 
Fisher 
had 
already 
rejected 
this 
interpretation: 
‚
I 
have 
never, 
indeed, 
written 
about 
G 
]iV] 
and 
its 
relationships 
. 
. 
the 
existence 
of 
such 
a 
potential 
func- 
tion 
[i.e. 
a 
function 
nondecreasing 
in 
time] 
. 
. 
F 
is 
not 
a 
general 
property 
of 
natural 
populations, 
but 
arises 
only 
in 
the 
special 
and 
restricted 
cases 
Wright 
considers
™ 
(Ref. 
7, 
p. 
285). 
Here, 
we 
reconsider 
Fisher
™
s 
Fundamental 
Theorem 
and 
its 
relationship 
to 
Adaptive 
Land- 
scapes. 
We 
focus 
on 
three 
ques- 
tions: 
What 
did 
Fisher 
really 
mean 
by 
the 
Fundamental 
Theorem? 
Is 
Fisher
™
s 
interpretation 
of 
the 
Fun- 
damental 
Theorem 
useful? 
Why 
was 
Fisher 
misinterpreted, 
even 
though 
he 
stated 
on 
many 
occasions 
that 
he 
was 
not 
talking 
about 
the 
average 
fitness 
of 
a 
population? 
What 
did 
Fisher 
really 
mean? 
The 
standard 
interpretation 
of 
the 
Fundamental 
Theorem 
is 
that 
natural 
selection 
increases 
the 
average 
fitness 
of 
a 
population 
at 
a 
rate 
equal 
to 
the 
genetic 
variance 
in 
fitness. 
Thus, 
the 
average 
fitness 
of 
a 
population 
is 
a 
nondecreasing 
quantity. 
This 
interpretation 
is 
in 
accord 
with 
the 
intuitively 
appeal- 
ing 
idea 
that 
natural 
selection 
will 
make 
species 
better 
adapted 
to 
their 
environments. 
One 
problem 
with 
the 
standard 
interpretation 
of 
the 
Fundamental 
Theorem 
is 
that, 
although 
Fisher 
claimed 
that 
his 
theorem 
is 
exact, 
realistic 
models 
show 
that 
average 
fitness 
does 
not 
always 
increase. 
For 
example, 
Moran8 
showed 
that 
average 
fitness 
can 
decrease 
when 
selection 
acts 
on 
two 
linked 
loci 
that 
have 
epistatic 
effects 
on 
fitness 
(see 
Box 
I 
for 
definition 
of 
genetical 
terms). 
In 
general, 
the 
average 
fitness 
of 
a 
population 
increases 
at 
a 
rate 
equal 
to 
the 
additive 
variance 
in 
fitness 
only 
when 
certain 
restric- 
tive 
conditions 
are 
met. 
For 
ex- 
ample, 
there 
must 
be 
no 
epistasis, 
no 
linkage 
disequilibrium 
and 
no 
frequency 
dependence, 
among 
a 
variety 
of 
other 
conditions 
about 
mating 
and 
nonadditive 
genetic 
interactions
™
O,ﬁ. 
Given 
that 
the 
standard 
interpret- 
ation 
was 
generally 
believed 
to 
be 
what 
the 
Fundamental 
Theorem 
was 
about, 
several 
theoreticians 
begin- 
ning 
with 
Kimural 
have 
focused 
on 
the 
question 
of 
when 
the 
average 
fitness 
of 
a 
population 
increases 
at 
a 
rate 
approximately 
equal 
to 
the 
additive 
variance 
in 
fitness. 
Recently, 
Nagylaki13 
has 
obtained 
upper 
bounds 
on 
the 
error 
made 
in 
assuming 
that 
the 
average 
fitness 
increases 
at 
a 
rate 
equal 
to 
the 
additive 
variance 
in 
fitness. 
However, 
PriceI 
and 
Ewens5 
have 
shown 
convincingly 
that 
the 
standard 
interpretation 
is 
very 
dif- 
ferent 
from 
what 
Fisher 
had 
in 
mind, 
0 
1992, 
Elsewer 
Science 
Publishers 
Ltd 
(UK) 

TREE 
vol. 
7, 
no. 
3, 
March 
7992 
and 
they 
propose 
an 
alternative 
explanation 
that 
fits 
all 
the 
facts. 
Price 
and 
Ewens 
provide 
formal 
derivations 
of 
the 
Fundamental 
Theorem 
consistent 
with 
Fisher
™
s 
interpretation: 
the 
theorem 
is 
exact 
and 
general 
in 
every 
way 
that 
Fisher 
claimed. 
Our 
purpose 
here 
is 
to 
provide 
a 
sense 
of 
what 
Fisher 
meant 
rather 
than 
to 
repeat 
the 
mathematical 
and 
historical 
analyses 
provided 
by 
Price 
and 
Ewens. 
Fisher 
realized 
that 
the 
average 
fitness 
of 
a 
group 
is 
a 
useful 
quantity 
only 
in 
the 
wider 
context 
of 
other 
groups 
and 
the 
environ- 
ment: 
a 
species 
in 
the 
context 
of 
competitors, 
diseases 
and 
food 
availability; 
a 
genotype 
in 
the 
con- 
text 
of 
a 
particular 
mix 
of 
competing 
genotypes 
within 
the 
population; 
or 
an 
allele 
in 
the 
context 
of 
the 
frequency 
of 
competing 
alleles 
at 
a 
locus. 
To 
explain 
the 
notion 
of 
fac- 
tors 
extrinsic 
to 
the 
group 
being 
analysed, 
Fisher 
referred 
to 
all 
extrinsic 
forces 
as 
the 
environment. 
The 
total 
change 
in 
fitness 
overtime, 
in 
the 
context 
of 
the 
environment, 
E. 
can 
be 
defined 
as 
Aw 
= 
w
™
/ 
E
™ 
- 
ml 
E 
where 
primes 
denote 
one 
time 
step 
or 
instant 
into 
the 
future, 
and 
Aw 
is 
the 
total 
change 
in 
fitness 
which 
everyone 
had 
assumed 
was 
the 
object 
of 
Fisher
™
s 
analysis. 
Fisher
™
s 
theorem, 
however, 
was 
not 
concerned 
with 
the 
total 
evol- 
utionary 
change, 
which 
depends 
at 
least 
as 
much 
on 
changes 
in 
the 
environment 
as 
it 
does 
on 
natural 
selection. 
Instead, 
Fisher 
partitioned 
the 
total 
change 
into 
A.w=(w
™
I 
E-WI 
E) 
+ 
(iv) 
E
™
-W
™
I 
El 
(II 
Fisher 
called 
the 
first 
term 
the 
change 
in 
fitness 
caused 
by 
natural 
selection 
because 
there 
is 
a 
con- 
stant 
frame 
of 
reference, 
the 
initial 
environmental 
state 
E. 
The 
Fun- 
damental 
Theorem 
states 
that 
the 
change 
in 
fitness 
caused 
by 
natural 
selection 
is 
equal 
to 
the 
additive 
variance 
in 
fitness. 
Fisher 
referred 
to 
the 
second 
term 
as 
the 
change 
caused 
by 
the 
environment, 
or 
more 
often, 
as 
the 
change 
caused 
by 
the 
deterioration 
of 
the 
environment, 
to 
stress 
that 
this 
term 
is 
often 
negative 
because 
natural 
selection 
increases 
fitness 
but 
the 
total 
change 
in 
fitness 
is 
usually 
close 
to 
zero. 
Is 
Fisher
™
s 
interpretation 
useful? 
PriceI 
and 
Ewens5 
both 
ex- 
pressed 
deep 
disappointment 
in 
the 
Fundamental 
Theorem, 
and 
Nagylaki13 
has 
recently 
echoed 
that 
disappointment. 
Price 
states 
(Ref. 
14, 
p. 
139): 
‚
A 
. 
. 
. 
[gravel 
defect 
is 
the 
matter 
of 
the 
shifting 
standard 
of 
‚
fitness
™ 
that 
gives 
the 
paradox 
of 
M 
IFI 
tending 
always 
to 
increase 
and 
yet 
staying 
generally 
close 
to 
zero. 
Much 
more 
interesting 
would 
be 
a 
theorem 
telling 
of 
increase 
in 
‚
fitness
™ 
defined 
in 
terms 
of 
some 
fixed 
standard.
™ 
It 
is 
a 
matter 
of 
taste 
whether 
a 
particular 
partition 
of 
evolutionary 
change 
is 
useful; 
all 
of 
the 
com- 
ponent 
parts 
must 
ultimately 
sum 
to 
the 
same 
total 
change. 
We 
believe 
that 
Fisher
™
s 
partition 
is 
useful 
- 
indeed 
fundamental, 
To 
sup- 
port 
this 
conclusion, 
we 
analyse 
an 
interesting 
biological 
problem, 
the 
evolution 
of 
clutch 
size, 
and 
show 
that 
Fisher
™
s 
view 
leads 
to 
a 
sig- 
nificantly 
deeper 
understanding 
of 
the 
problem. 
In 
discussing 
clutch 
size 
it 
is 
not 
our 
intention 
to 
resolve 
differences 
among 
various 
models, 
but 
instead 
to 
illustrate 
an 
appli- 
cation 
of 
Fisher
™
s 
theorem. 
The 
problem, 
presented 
in 
a 
recent 
paper 
by 
Cooke 
et 
a1.15, 
is 
that 
many 
bird 
populations 
have 
considerable 
amounts 
of 
additive 
genetic 
variance 
for 
clutch 
size, 
and 
field 
studies 
typically 
show 
that 
larger 
clutch 
sizes 
would 
confer 
higher 
fitness. 
The 
paradox 
is 
often 
stated 
in 
terms 
of 
the 
standard 
interpretation 
of 
the 
Fundamen- 
tal 
Theorem: 
average 
clutch 
size 
is 
expected 
to 
increase 
because 
there 
is 
significant 
additive 
genetic 
variance 
in 
fitness 
attributable 
to 
differences 
in 
clutch 
size, 
but 
clutch 
sizes 
in 
natural 
populations 
are 
apparently 
not 
changing. 
Cooke 
et 
al. 
suggest 
that 
the 
average 
clutch 
size 
may 
remain 
fixed 
because 
of 
the 
balance 
between 
two 
forces: 
natural 
selection 
acts 
to 
increase 
clutch 
size, 
but 
a 
simul- 
taneous 
increase 
in 
competition 
for 
scarce 
resources 
reducesclutch 
size. 
These 
authors 
stated 
that 
their 
model 
is 
an 
extension 
of 
the 
Fun- 
damental 
Theorem 
rather 
than 
an 
Tee 
following 
d&in&ions 
provide 
a 
81ense 
of 
h&these 
con(;e#s 
ate 
typicatly 
used. 
Formal 
defMtiCns 
f= 
many 
of 
the 
following 
ten@% 
osn 
hefound 
in
™ 
F&olrlu~lfB 
or 
in 
other 
can 
has 

sen 
a 
in 
the 
poipllulartion 
be 
&lo&d 
to.4 
and 
measure 
th$1@~;R&typic 
Me~~ntre 
caused 
by 
the 
change. 
ﬁl
™
ljs 
ayerage 
&ang+ 
measured 
over 
dl 
a
™
s 
taken 
ona 
at 
a 
tin& 
is 
the 
aver- 
age 
effect 
of 
4, 
sub&U.&n 
by 
a. 
tie 
average 
effect 
of 
a 
sUbs$i@@ion 
at 
this1 
Focus 
is 
the 
diffBrenee 
between 
Slhe~averege 
effect 
of 
a 
su 
bst@ution 
by 
% 
anrl,,a 
+pbs&ution 
by 
A. 
The 
average 
effect 
is 
the 
fuw,ndation 
for 
the 
con- 
cepts 
and 
mathematieii 
oflithe 
Fundamental 
Theorem,
™ 
atid 
is 
atso 
the 
basis 
for 
many 
of 
Fisher
™
s 
critMams 
of 
Wright. 
Emrir@nmbnr 
is 
an 
i~p~~rtant 
aspeot 
of 
the 
FuntYaTentat 
Theorem. 
The 
werag& 
effect 
of 
in 
alfete 
takes 
irAt 
account 
a
™
ll 
poss- 
ible 
genetic 
and 
environmental 
effects 
by 
measuring 
the 
phenotypic 
change 
of 
a 
sub- 
stitution 
in 
the 
oontext 
of 
the 
current 
popu- 
lation. 
Whstn 
di,sctrraing 
his 
Fundamental 
Thso#m, 
Fisher 
chose 
to 
lump 
genetic 
ef- 
feats 
BI
™
uch 
as 
gene 
freq#tncy 
and 
dotiinance 
with 
bhyrsical 
effeet& 
s&h 
iss 
tieether 
into 
a 
single 
‚
envMntie@aP 
tarm. 
Add&& 
w#& 
,mEimcQ 
is 
a 
mealaw 
re 
for 
th
™
e 
~paten#al 
arr%@fit 
df 
evatuti@nery, 
Chalnge 
cau%ed 
by 
natural, 
o@l&an. 
For 
a 
singi
™
e 
locus, 
the 
measura
™
is 
ciibtdiiiM6j 
by 
muttiptying 
the 
squ
™
are 
of 
the 
averagls
™
e#f&t 
af 
a 
substi- 
tution 
by 
the 
variame 
ir4 
&ne 
frequency 
- 
es$entMly, 
the 
amount 
&ckc;arrg(e 
caused 
by 
a 
rise 
or 
fal
™
l 
is 
gqrte 
frequency 
imul?iiIpfie,d 
by 
the 
amount 
of 
variabil-m 
in 
gehetic 
material 
presently 
ava~jlable. 
EpistasY 
i&e 
enetic 
interaction 
between 
P 
diffeent 
loci. 
Epr,Matic 
interactions 
are 
non- 
zero 
if 
the 
av~&ge~~rff&t 
of 
a 
substitution 
at 
one 
locus 
d#~ends 
on 
the 
genotype 
fre- 
quencies 
at 
a 
S. 
LtlSIcs~ 
41 
Is 
the 
statistica 
correla&n 
be&++ 
&Wee5 
at 
cbWmnt 
loci. 
Lilnkage 
d&sequilibri:um 
is 
nonzero 
if 
multi- 
lclcus 
gsmete 
frequmcncies 
are 
differqnt 
from 
rhe 
product 
of 
the 
elm& 
Mqueneies 
at 
each 
IOCU~S. 
Fmsncy 
dependllnce 
occurs 
when 
the 
absolute 
fitness
™
(nurpber 
of 
eucceMul 
vff- 
spring) 
of 
a 
genoiryps 
depends 
on 
the 
frelqueney 
of 
genoV@es
™ 
in 
the 
popuMion. 
DeMsi& 
depem%@Mi 
&curs 
when 
the 
eb- 
solute 
fitness 
of
™
!4 
girn~leypa 
depends 
#On 
Ehe 
numbsr 
of 
individuals 
lin 
the 
population. 
application 
of 
the 
theorem. 
They 
cite 
the 
standard 
interpretation 
of 
the 
theorem, 
including 
Wright
™
ﬂ 
and 
Crow 
and 
Kimural
™
, 
to 
support 
their 
conclusion. 
In 
fact, 
Cooke 
etal.
‚
s 
model 
is 
not 
an 
extension 
but 
a 
specific 
example 
of 
Fisher
™
s 
partition 
of 
evolutionary 
change 
into 
a 
component 
caused 
by 
natural 
selection 
and 
a 
component 
caused 
by 
the 
environment. 
Fisher 
often 
referred 
to 
the 
environmental 
component 
as 
a 
‚
deterioration 
in 
the 
environment
™
, 
and, 
as 
one 
example, 
he 
discussed 
this 
deterioration 
in 
93 

TREE 
vol. 
7, 
no. 
3, 
March 
7992 
terms 
of 
an 
increase 
in 
ecological 
pressure 
on 
population 
growth. 
We 
recast 
Cooke 
et 
al.% 
argument 
in 
terms 
of 
Fisher
™
s 
analysis 
in 
order 
to 
show 
the 
relationship 
between 
the 
clutch-size 
exampleand 
Fisher
™
s 
ecological 
view 
of 
evolutionary 
change. 
Cooke 
et 
al. 
consider 
clutch 
size, 
P, 
which 
can 
be 
equated 
to 
fitness. 
(P 
is 
used 
to 
denote 
phenotype.) 
P 
depends 
on 
two 
factors, 
P 
= 
P,T,, 
where 
P, 
is 
the 
number 
of 
eggs 
per 
unit 
area 
of 
territory 
held 
by 
the 
bird, 
and 
T2 
is 
territory 
size. 
Territory, 
in 
turn, 
depends 
on 
T, 
= 
(AIN)P,I& 
where 
A 
is 
the 
total 
area 
avail- 
able 
for 
territories, 
N 
is 
population 
size, 
and 
P2 
summarizes 
the 
physical 
and 
behavioral 
traits 
that 
determine 
aggressiveness 
and 
thus 
relative 
territory 
size. 
(All 
capital 
letters 
are 
random 
variables; 
overbars 
denote 
population 
averages.1 
With 
these 
definitions, 
the 
clutch 
size, 
P, 
and 
the 
environmental 
influ- 
ence 
on 
clutch 
size, 
E, 
are 
given 
by 
P 
= 
P,P,E 
E 
= 
AIN& 
From 
Eqn 
1 
above, 
the 
total 
change 
in 
the 
population 
mean 
for 
P 
is 
AP 
= 
(PIE- 
i$E) 
+ 
(P
™
lE
™
- 
PIEI 
(2) 
The 
first 
term 
is 
the 
expected 
response 
to 
selection 
when 
measured 
in 
the 
context 
of 
the 
original 
environmental 
state; 
this 
response 
is 
equal 
to 
the 
additive 
variance 
in 
fitness. 
The 
second 
term 
is 
the 
contribution 
of 
changing 
environment 
to 
the 
total 
change 
in 
clutch 
size. 
This 
equation 
for 
the 
total 
change, 
Ai? 
corresponds 
to 
the 
traditional 
quantitative 
genetic 
formulation 
(see 
Eqn 
2 
in 
Ref. 
15). 
94 
The 
puzzle 
to 
solve 
is: 
why 
doesn
™
t 
clutch 
size 
increase 
even 
though 
the 
first 
term, 
the 
additive 
variance 
in 
fitness 
for 
clutch 
size, 
is 
often 
quite 
large? 
Cooke 
et 
al. 
suggest 
that 
a 
decrease 
in 
the 
environmental 
term 
can 
strike 
a 
balance 
so 
that 
no 
evolutionary 
change 
in 
clutch 
size 
occurs. 
In 
Cooke 
et 
al.
‚
s 
model, 
there 
are 
two 
ways 
in 
which 
environmental 
deterioration 
may 
occur. 
First, 
sup- 
pose 
that 
P, 
is 
fixed 
and 
that 
only 
the 
level 
of 
aggressiveness, 
P2, 
is 
variable. 
Then, 
from 
Eqn 
2, 
the 
change 
in 
ij 
is 
zero 
because 
- 
- 
AP 
cc 
(P:/& 
- 
Pip,) 
+ 
(p
™
,IP
™
, 
- 
F
™
*/FJ 
(3) 
where 
the 
first 
term 
is 
proportional 
to 
the 
increase 
in 
the 
average 
level 
of 
aggressiveness 
in 
the 
population 
caused 
by 
natural 
selection, 
and 
the 
second 
term 
is 
proportional 
to 
the 
decrease 
in 
clutch 
size 
caused 
by 
the 
increase 
in 
the 
average 
level 
of 
competition 
for 
space. 
The 
second 
type 
of 
environmen- 
tal 
deterioration 
occurs 
when 
P2 
is 
fixed 
and 
the 
number 
of 
eggs 
per 
unit 
area, 
P,, 
varies. 
In 
this 
case, 
the 
proportional 
change 
in 
P 
is 
given 
by 
AP 
CC 
(ij
™
,/N 
- 
p,/N) 
+(p
™
,/N
™ 
- 
P
™
,/N) 
If 
one 
makes 
the 
reasonable 
as- 
sumption 
that 
the 
carrying 
capacity, 
N, 
is 
proportional 
to 
the 
number 
of 
eggs 
that 
can 
be 
raised 
per 
unit 
of 
territory, 
P,, 
then 
AP 
= 
0. 
This 
balance 
occurs 
because 
the 
increase 
in 
efficiency 
caused 
by 
natural 
selection 
(the 
first 
term) 
is 
exactly 
balanced 
by 
the 
increased 
competition 
for 
space 
(the 
second 
term). 
In 
this 
last 
case, 
clutch 
size 
and 
the 
intrinsic 
rate 
of 
increase 
(mean 
fitness) 
of 
the 
population 
do 
not 
change, 
but 
the 
population 
size 
does 
increase 
(see 
Ref. 
18, 
p. 
201). 
This 
is 
exactly 
the 
situation 
that 
Fisher 
had 
in 
mind 
for 
the 
only 
case 
in 
which 
he 
explicitly 
discussed 
the 
evolution 
of 
the 
total 
change 
in 
population 
mean 
fitness 
(Ref. 
4, 
pp. 
45-46): 
An 
increase 
in 
numbers 
of 
any 
organism 
will 
impair 
its 
environ- 
ment 
in 
a 
manner 
analogous 
to, 
and 
more 
surely 
than, 
an 
increase 
in 
the 
numbers 
or 
efficiency 
of 
its 
competitors. 
It 
is 
a 
patent 
oversimplification 
to 
assert 
that 
the 
environment 
determines 
the 
numbers 
of 
each 
sort 
of 
organism 
which 
it 
will 
support. 
The 
numbers 
must 
indeed 
be 
determined 
by 
the 
elastic 
quality 
of 
the 
resist- 
ance 
offered 
to 
increase 
in 
num- 
bers, 
so 
that 
life 
is 
made 
some- 
what 
harder 
to 
each 
individual 
when 
the 
population 
is 
larger, 
and 
easier 
when 
the 
population 
is 
smaller. 
The 
balance 
left 
over 
when 
from 
the 
rate 
of 
increase 
in 
the 
mean 
value 
of 
m 
[WI 
produced 
by 
Natural 
Selection, 
is 
deducted 
the 
rate 
of 
decrease 
due 
to 
deterioration 
in 
environ- 
ment, 
results 
not 
in 
an 
increase 
in 
the 
average 
value 
of 
m, 
for 
this 
average 
value 
cannot 
greatly 
exceed 
zero, 
but 
principally 
in 
a 
steady 
increase 
in 
population. 
Another 
interesting 
aspect 
of 
Fisher
™
s 
view 
is 
that 
gene-frequency 
change 
and 
evolution 
may 
be 
occurring 
continually 
even 
though 
there 
is 
no 
net 
change 
in 
mean 
fitness: 
‚
Intense 
selective 
activity 
is 
shown 
to 
be 
compatible 
with 
an 
entire 
absence 
of 
change 
in 
the 
average 
survival 
value 
of 
the 
population
™ 
(Ref. 
3, 
p. 
63). 
Why 
was 
Fisher 
misunderstood? 
We 
think 
that 
Fisher 
was 
misunderstood 
because 
most 
evol- 
utionary 
biologists 
sought 
a 
simple 
dynamic 
theory 
of 
evolution. 
That 
is 
what 
Wright
™
s 
Adaptive 
Landscape 
provided. 
By 
contrast, 
Fisher 
did 
not 
seek 
a 
dynamic 
theory 
and, 
in 
fact, 
he 
believed 
that 
changes 
in 
fitness 
caused 
by 
natural 
selection 
could 
never 
be 
equated 
with 
the 
total 
evolutionary 
change 
in 
fitness. 
The 
first 
sentence 
in 
the 
preface 
of 
his 
book4, 
The 
Genetical 
Theory 
of 
Natural 
Selection, 
is: 
‚
Natural 
Selection 
is 
not 
Evolution.
™ 
When 
Fisher 
discussed 
the 
evol- 
ution 
of 
a 
trait, 
he 
generally 
considered 
the 
direct 
effect 
of 
natural 
selection, 
and 
the 
feedback 
caused 
by 
ecological 
changes 
due 
to 
natural 
selection. 
Instead 
of 
provid- 
ing 
a 
precise 
description 
for 
the 
total 
change 
expected, 
he 
discussed 
at 
some 
length 
the 
difficulties 
in- 
volved 
in 
estimating 
all 
of 
the 
relevant 
selective 
and 
ecologi- 
cal 
parameters 
involved 
(Ref. 
4, 
pp. 
45-49). 
Fisher
™
s 
ecological, 
holistic 
view, 
and 
the 
very 
reasonable 
interpret- 
ation 
of 
clutch 
size 
that 
follows 
from 
this 
view, 
apparently 
leaves 
Fisher 
in 
a 
safe 
and 
comfortable 
position. 
But 
our 
discussion 
so 
far 
has 
not 
addressed 
two 
important 
issues. 
The 
first 
concerns 
Fisher
™
s 
use 
of 
changing 
gene 
frequencies 
as 
an 
ecological 
factor 
subsumed 
within 
the 
environmental 
component 
of 
evolutionary 
changeﬂ. 
The 
second 
issue 
concerns 
Fisher
™
s 
criticisms 
of 
the 
Adaptive 
Landscape. 

. 
TREE 
vol. 
7, 
no. 
3, 
March 
7992 
Fisher
™
s 
peculiar 
treatment 
of 
changing 
gene 
frequency 
as 
part 
of 
the 
environment 
can 
be 
seen 
by 
an 
analogy 
with 
the 
clutch-size 
example 
of 
the 
previous 
section. 
In 
that 
example, 
the 
level 
of 
aggress- 
iveness, 
PI, 
may 
evolve 
by 
the 
direct 
action 
of 
natural 
selection, 
as 
shown 
in 
the 
first 
term 
of 
Eqn 
3, 
but 
the 
increase 
in 
the 
average 
value 
of 
aggressiveness, 
P2, 
is 
treated 
as 
an 
environmental 
variable, 
in 
the 
second 
term 
of 
Eqn 
3. 
Fisher 
followed 
an 
analogous 
par- 
tition 
at 
the 
gene-frequency 
level. 
By 
his 
view, 
natural 
selection 
in- 
creases 
the 
frequency 
of 
a 
particular 
allele 
according 
to 
its 
average 
effect 
on 
fitness, 
which 
depends 
on 
the 
frequencies 
and 
combinations 
of 
other 
alleles 
- 
the 
genotypic 
‚
en- 
vironment
™
. 
Here 
allele 
frequency 
is 
a 
character 
correlated 
with 
fitness, 
and 
natural 
selection 
affects 
mean 
fitness 
according 
to 
the 
additive 
variance 
in 
fitness 
associated 
with 
allele 
frequency. 
The 
peculiar 
part 
of 
Fisher
™
s 
argument 
is 
that 
any 
change 
in 
fitness 
caused 
by 
a 
change 
in 
the 
average 
effect 
of 
an 
allele 
is 
an 
environmental 
effect. 
Because 
the 
average 
effect 
of 
an 
allele 
often 
depends 
on 
its 
frequency, 
a 
change 
in 
allele 
frequency 
caused 
by 
natural 
selection 
is 
also 
a 
change 
in 
the 
environment. 
By 
this 
formu- 
lation, 
fitness, 
or 
a 
trait 
correlated 
with 
fitness, 
increases 
by 
an 
exact 
amount 
because 
of 
natural 
selection 
but 
simultaneously 
increases 
or 
decreases 
by 
an 
unpredictable 
amount 
because 
of 
the 
‚
environ- 
ment
™
. 
The 
Fundamental 
Theorem 
provides 
no 
general 
statement 
about 
evolutionary 
change. 
There 
is, 
naturally, 
a 
certain 
dis- 
appointment 
that 
the 
theorem 
says 
nothing 
about 
evolutionary 
dynam- 
ics. 
Indeed, 
since 
the 
goal 
of 
math- 
ematical 
population 
genetics 
is 
to 
provide 
explicit 
dynamical 
models, 
it 
is 
not 
surprising 
that 
most 
authors 
have 
assumed 
that 
Fisher
™
s 
theorem 
was 
intended 
to 
be 
part 
of 
a 
dynamical 
theory, 
or 
else 
have 
expressed 
disappointment 
when 
they 
realized 
what 
Fisher 
had 
really 
done. 
What 
one 
gains 
from 
the 
Fun- 
damental 
Theorem, 
however, 
is 
a 
stronger 
ecological 
sense 
of 
the 
relationship 
between 
natural 
selec- 
tion 
and 
evolution: 
the 
evolution 
of 
mean 
fitness, 
or 
of 
a 
character 
corre- 
lated 
with 
fitness, 
is 
interesting 
only 
in 
the 
context 
of 
population 
dy 
namics. 
Similarly, 
the 
evolutionary 
significance 
of 
changing 
gene 
fre- 
quency 
can 
only 
be 
understood 
in 
the 
context 
of 
the 
genomic 
environ- 
ment. 
Fitness 
gradients 
and 
ecology 
Fisher 
did 
not 
question 
the 
math- 
ematical 
validity 
of 
Wright
™
s 
equa- 
tions. 
He 
did, 
however, 
question 
the 
evolutionary 
significance 
of 
the 
mean-fitness 
gradient 
because 
it 
ignores 
the 
ecological 
aspects 
of 
evolutionary 
change. 
The 
gradient 
approach 
can 
in- 
corporate 
‚
genomic 
ecology
™ 
(e.g. 
epistasis, 
frequency 
dependence) 
and 
population 
ecology 
(density 
dependence 
)19, 
but 
the 
primary 
use 
of 
the 
gradient 
for 
predicting 
or 
interpreting 
the 
evolutionary 
conse- 
quences 
of 
selection 
has 
been 
based 
on 
the 
uncorrected 
Adaptive 
Landscape 
that 
Fisher 
criticized. 
The 
tension 
continues 
between 
fitness-gradient 
and 
ecological 
views 
of 
evolution. 
On 
one 
side, 
much 
of 
evolutionary 
quantitative 
genetic 
theory 
and 
the 
inferences 
drawn 
from 
measurements 
of 
selection 
in 
the 
wild 
have 
been 
based 
on 
the 
mean-fitnessgradient. 
On 
the 
other 
side, 
Cooke 
et 
al.
‚
s 
model 
shows 
clearly 
that 
measure- 
ments 
of 
selection 
on 
traits 
like 
clutch 
size 
may 
be 
misleading 
if 
interpreted 
outside 
of 
their 
eco- 
logical 
context: 
a 
fitness 
gradient 
(Adaptive 
Landscape) 
is 
not 
sufficient 
to 
infer 
evolutionary 
history 
or 
to 
predict 
future 
changes 
in 
traits 
correlated 
with 
fitness. 
Acknowledgements 
We 
thank 
N. 
Barton, 
R. 
Bush, 
F. 
Cooke, 
1. 
Crow, 
W. 
Ewens, 
0. 
Kempthorne, 
M. 
Kirkpatrick, 
T. 
Nagylaki, 
T. 
Price, 
P. 
Taylor, 
M. 
Turelli 
and 
M. 
Wade 
for 
their 
comments. 
SAF
™
s 
research 
is 
supported 
in 
part 
by 
NIH 
grants 
GM42403 
and 
BRSG-S07-RR07008 
and 
NSF 
grant 
BSR-905733 
I. 
References 
I 
Wright, 
S. 
(1932) 
Proc. 
Sixth 
Int. 
Congr 
Cenet. 
I, 
356-366 
2 
Provine, 
W.B. 
( 
1986) 
Sewall 
Wright 
and 
Evolutionary 
Biology, 
University 
of 
Chicago 
Press 
3 
Fisher, 
R.A. 
( 
I94 
I 
) 
Ann. 
Eugen. 
I 
I, 
53-63 
4 
Fisher, 
R.A. 
f 
1958) 
The 
Genetical 
Theory 
of 
Natural 
Selection 
(2nd 
edn), 
Dover 
5 
Ewens, 
W.J. 
( 
1989) 
Theor. 
Popul. 
Biol. 
36, 
167-180 
6 
Wright, 
7 
Fisher, 
S. 
(1988) 
Am. 
Nat. 
131. 
115-123 
R.A. 
( 
I9581 
I. 
Ecol. 
46. 
289-293 
8 
Moran, 
P.A.P. 
(1964) 
Ann. 
Hum. 
Genet. 
27, 
383-393 
9 
Falconer, 
D.S. 
(I981 
I 
Introduction 
to 
Quantitative 
Genetics 
(2nd 
ednf, 
Longman 
IO 
Crow, 
1.F. 
and 
Nagylaki, 
T. 
(19761 
Am. 
Nat. 
I 
IO, 
207-2 
I3 
II 
Kimura, 
M. 
119581 
Heredity 
12. 
145-167 
12 
Kimura, 
M. 
11965) 
Genetics 
52, 
875-890 
13 
Nagylaki, 
T. 
(1991 
I 
Proc. 
Nat/ 
Acad. 
Sci. 
USA 
88. 
2402-2406 
I4 
Price, 
G.R. 
11972) 
Ann. 
Hum. 
Cenet. 
36, 
129-140 
I5 
Cooke, 
F., 
Taylor, 
P.D., 
Francis, 
CM. 
and 
Rockwell, 
R.F. 
11990) 
Am. 
Nat. 
136, 
261-267 
I6 
Wright, 
S. 
(1949) 
in 
Genetics, 
Paleontology 
and 
Evolution 
ffepson, 
G.L., 
Simpson, 
G.G. 
and 
Mayr, 
E.. 
eds), 
pp. 
365-389, 
Princeton 
University 
Press 
I7 
Crow, 
J.F. 
and 
Kimura, 
M. 
(1970) 
An 
introduction 
to 
Population 
Genetics 
Theory 
Harper 
& 
Row 
I8 
Charlesworth, 
B. 
(1980) 
Evolution 
in 
Age-Structured 
Populations, 
Cambridge 
University 
Press 
I9 
Barton, 
N.H. 
and 
Turelli, 
M. 
(1987) 
Genet. 
Res. 
49, 
157-l 
73 


===== Price_equation.pdf =====
5
	


===== viral_paper.pdf =====
QuantitativeModelingofVirusEvolutionaryDynamicsand
AdaptationinSerialPassagesUsingEmpiricallyInferredFitness

Landscapes
HyungJunWoo
,
JaquesReifman
‹
BiotechnologyHighPerformanceComputingSoftwareApplicationsInstitute,TelemedicineandAdvancedTechnologyResearchCenter,U.S.ArmyMedi
calResearchand
MaterielCommand,FortDetrick,Maryland,USA
WedescribeastochasticvirusevolutionmodelrepresentinggenomicdiversiÞcationandwithin-hostselectionduringexperi-
mentalserialpassagesundercellcultureorlive-hostconditions.Themodelincorporatesrealisticdescriptionsofthevirusgeno-

typesinnucleotideandaminoacidsequencespaces,aswellastheirdiversiÞcationfromerror-pronereplications.Itquantita-

tivelyconsidersfactorssuchastargetcellnumber,bottlenecksize,passageperiod,infectionandcelldeathrates,andthe

replicationrateofdifferentgenotypes,allowingforsystematicexaminationsofhowtheirchangesaffecttheevolutionarydy-

namicsofvirusesduringpassages.Therelativeprobabilityforaviralpopulationtoachieveadaptationunderanewhostenvi-

ronment,quantiÞedbytheratewithwhichatargetsequencefrequencyrisesabove50%,wasfoundtobemostsensitivetofac-

torsrelatedtosequencestructure(distancefromthewildtypetothetarget)andselectionstrength(hostcellnumberand

bottlenecksize).ForparametervaluesrepresentativeofRNAviruses,thelikelihoodofobservingadaptationsduringpassages

becamenegligibleastherequirednumberofmutationsroseabovetwoaminoacidsites.WemodeledthespeciÞcadaptation

processofinßuenzaAH5N1virusesinmammalianhostsbysimulatingtheevolutionarydynamicsofH5strainsundertheÞt-

nesslandscapeinferredfrommultiplesequencealignmentsofH3proteins.InlightofcomparisonswithexperimentalÞndings,

weobservedthattheevolutionarydynamicsofadaptationisstronglyaffectednotonlybythetendencytowardincreasingÞtness

valuesbutalsobytheaccessibilityofpathwaysbetweengenotypesconstrainedbythegeneticcode.
V
iruseswithRNAgenomesevolverapidly,evadingselective
pressurefromthehostimmuneresponseandadaptingto
changingenvironments (
1Œ4
). Inparticular, their capacity to
switchhostspecies,emergeintonewvulnerablepopulations,and

causeoutbreakshassigni˚cantimplicationsforviraldiseasecon-

trol(
5
).Manysuchoutbreaksinrecenthistoryhavebeenattrib-
utedtoviralspeciesjumps:in˜uenzaAvirushasjumpedfrom

birdsandpigstohumansmultipletimes(
6Œ9
),thesevereacute
respiratorysyndrome(SARS)epidemicwascausedbyaspecies

jumpofcoronavirusfrombatsandpalmcivetstohumans(
10Œ
13
),andhumanimmunode˚ciencyvirustype1(HIV-1)isbe-
lieved to have switched hosts from primates (
14
).
Characterizingthecomplexfactorsaffectingtheevolutionof
virusesinnaturalsettingsamongdiversegroupsofinteracting

hostsisachallengingtask.Valuableinsightshavebeengainedby

evolutionaryexperimentsundermorecontrolledconditions,par-

ticularlywithinthecontextofserial-passageexperiments(
15
).In
aserial-passageexperiment,acellcultureorlivehostisinoculated

byviral(orother)pathogens,usuallyalreadywelladaptedtodif-

ferentcelltypesorhosts.Apathogen™sgrowthundertherestric-

tivehostenvironmentleadstowithin-hostselectionforadvanta-

geousvariants,eitherpresentasaminorityinthefounder

populationorgeneratedfromerror-pronereplications.Aftera

certainamountoftime(approximatelydays)ofsuchgrowths,a

small subset of the resulting pathogen population is sampled and
usedtoinoculateafreshnewmediumorhost,initiatingasubse-

quentroundofthepassage.Generally,rapidadaptationtothenew

hostenvironmentintheformofincreased˚tnessandvirulenceis

observed(typicallywithin

10passages)alongwithattenuation
ofadaptationtotheformerhost(
15
).Inadditiontorevealingkey
adaptation strategies a pathogen can exhibit, an important appli-
cationofserial passages is theproductionof attenuatedvaccine
strainscapableofelicitingimmuneresponseswithoutvirulence

(
16
).
Therecentavailabilityofrapidandinexpensivedeep-sequenc-
ingtechniques(
17
)hasthepotentialtosigni˚cantlyimproveour
understandingofhowkeyfactorsaffectvirusevolutionarydy-

namics, including species jumps, especially when combinedwith

controlledexperimentssuchasserialpassages.Amajorobstaclein

leveragingthegrowingsequencedata,however,isthelackof

quantitativeconnectionsbetweensuchgenotypedataandexper-

imentallymeasurableviralphenotypes,includinggrowthproper-

ties,infectivity,virulence,andtissuetropism.Themainobjective

ofthisstudywastodevelop,validate,andapplystochasticmodels
ofviralevolutionarydynamicsthatcanbridgethisgapbyrealis-

tically modeling genomic diversi˚cation and adaptation processes

during serial passages.
Mathematicalmodelsofviraldynamicshavelongbeenusedto
obtaininsightsintohowvirusesinteractwithandadapttodiffer-

enthosts.Themainstayamongsuchmodelsisthecontinuum

descriptionofpopulationdynamicsformulatedwithordinarydif-

ferentialequations(
18Œ20
).Oneoftheirdrawbacks,however,is
thattheyarenotreadilyextendabletodescriptionsofextensive
Received
9October2013
Accepted
30October2013
Publishedaheadofprint
6November2013
AddresscorrespondencetoHyungJunWoo,hwoo@bhsai.org,orJaquesReifman,
jaques.reifman.civ@mail.mil.
Copyright©2014,AmericanSocietyforMicrobiology.AllRightsReserved.
doi:10.1128/JVI.02958-13
January2014Volume88Number2JournalofVirology p.1039–1050
jvi.asm.org
1039

genomicdiversi˚cationprocesses.Leeetal.havemodeledHIV-1
intrahostsequenceevolutionanddivergence(
21
).Limetal.stud-
iedthedesignofgrowth-attenuatedvirusesusingcomputational

modelsfortheintracellulargrowthofvesicularstomatitisviruses

(
22
,
23
).Evolutionarybottleneckeffectsassociatedwithserialpas-
sageshavebeenmodeledusingadifferentmathematicalapproach

(
24
,
25
).Explicitdescriptionsofwithin-hostdynamicswithmu-
tations have been used by Russell et al. (
26
) to examine the poten-
tialforemergenceofairborne-transmissiblein˜uenzaAH5N1

virusvariants(
6
,
27
),butwithoutconsiderationofserialpassages
used in the experiment.
Recently,weintroducedastochasticdynamics-basedmodel-
ingframeworkofvirusdynamicsunderimmuneselectivepres-

sure(
28
).Itcombinestheclassicquasispeciestheorydescription
ofmutation-selectionbalance(
1
,
29
,
30
)andthediscrete-state
stochasticsimulationalgorithmwidelyusedforchemicalreac-

tions(
31
).ThemodelwassuccessfullyusedtodescribeHIV-1
within-hostdynamicsinbothshort(immuneescapedynamics)

andlong(diseaseprogression)timescales.Inthisstudy,wedevel-

oped an analogous stochastic model suitable for describing the

within-hostadaptationofvirusesinserialpassages.Wedemon-

stratedthattheapproachallowsonetoquantitativelyprobethe

effectsofkeyfactorsofevolutionarydynamicsonadaptation,in-

cludingthe˚tnessdistributioninsequencespace,bottlenecksize,

andmutationrate.Inparticular,weexaminedtheadaptationpro-

cessbyconsideringtherelativeaccessibilityofgenotypeswell

adaptedtoanewhostenvironmentfromthestartingstockduring

passages.Wefoundthatthenumberofpassageroundsnecessary

toachievethisadaptationincreasesexponentiallywiththere-

quirednumberofaminoacidmutations,renderingtriplemutants

practicallyinaccessible.Thisobservationisconsistentwithexper-

imentalstudiesoftheadaptationofin˜uenzaAH5N1viruses(
6
)
and SARS coronavirus (CoV) (
12
).
Inparticular,forin˜uenzaAH5N1viruses,whicharenor-
mallyrestrictedtoavianhostsbutcanoccasionallyspilloverinto

mammals,speci˚chemagglutinin(HA)mutationsthatallowfor

binding to mammalian receptors have been suggested as the key

factorforpotentialspeciesjumps(
6
,
27
).Uponserialpassagingin
ferretsofanengineeredstraincontainingthreemutations(twoin

HA)knowntofacilitatereceptorbinding,viralstrainscapableof

respiratoryinfectioncontainingtwoadditionalmutationswere

found.Modelingtheevolutionaryadaptationofsuchspeci˚csys-

temsrequiresanempirical˚tnesslandscape(thecorrespondence

relationshipbetweengenotypesandreplicationrate),whichcould

beinferredfromasuf˚cientlylargesetofmultiple-sequencealign-

ments(MSAs).Forthis˚tnessinferenceprocedure,weadopted

thedirectcouplinganalysis(
32
,
33
),amethodintendedforex-
tractingthedegreeofcoevolutionbetweensiteswithinaprotein

duemostlytodirectspatialinteractionsthatareobscuredinfre-

quencycorrelationdata.Itallowsforthedeterminationofamax-

imum-entropy˚tnessfunction(aﬁdisorderedPottsmodelﬂ)that

canbeusedtoestimate˚tnessvaluesofarbitrarysequences,while

takingintoaccountinterresiduecorrelations.Fergusonetal.have

recentlyusedasimilarapproachintheirstudyofHIV˚tnessland-

scapes,butemployingareduceddescriptionofatwo-letteralpha-

bet(wildtype[WT]andmutant)andMonteCarlosimulations

for inference (
34
) rather than the mean ˚eld approximation de-
veloped by Morcos et al. (
33
). We used this inferred landscape to
simulatetheadaptationofH5N1:anH5proteinsegmentevolves

underthe˚tnesslandscapeinferredfromsequences(H3)natural
tomammalianhosts,e.g.,theH3N2subtypeendemicinhuman
populations.Oursimulationsrevealedthatboththe˚tnessvalues

ofgenotypesandtheirrelativeaccessibilitiesdictatedbythege-

netic code strongly affect the adaptation dynamics.
MATERIALSANDMETHODS
Stochasticmodelandsimulation.
Thebasicmodelofvirusevolutioncan
bedescribedbythefollowingsetofevents:
U

V
n

a
I
n
(infection)(1)
I
n

Q
mn
r
n
I
n

V
m
(replication) (2)
I
n

b
0 (death)(3)
V
n

b
0 (clearance)(4)
where
U
isanuninfectedhostcelland
V
n
and
I
n
areavirionwithgenotype
n
andacellinfectedwithit,respectively.Equation1representstheinfec-
tionofahostcellwithrate
a
,andequation2correspondstoareplication
eventinwhichaninfectedcellofgenotype
n
shedsavirionwithgenotype
m
withreplicationrate
r
n
andmutationprobability(
29
,
30
),
Q
mn

(1

)
L

d
mn
(

)
d
mn
(5)
where

is the mutation rate (probability for substitutionper nucleotide
site perreplication),
L
is thetotallength ofthegenomic nucleotideseg-
ment,and
d
mn
istheHammingdistance(totalnumberofnucleotidesthat
differ)betweengenotypes
m
and
n
.Equation5givesthejointprobability
ofmutating
d
mn
siteswithprobability

/3(oneoutofthreepossibilities
from
n
to
m
),whileleaving
L

d
mn
sitesalonewithprobability1

.In
theactualsimulations,equation5isaconsequenceofthealgorithmrather
thananinput,becausethetargetgenotype
m
isdeterminedbyrandomly
mutatingeachsiteofgenotype
n
withprobability

/3intooneofthree
possibilities.Thegenomelengthisamultipleof3suchthat
L

3
L
a
,where
L
a
isthenumberofaminoacids.Agivengenotype
n
istranslatedintothe
correspondingaminoacidsequence

(
n
)usingthestandardgenetic
code.Thereplicationrate
r
n
isafunctionofaminoacidsequenceonly:
r
n

r

(
n
)
.Equations3and4representthedeathofaninfectedcelland
theclearanceofavirion,respectively,whichareassumedtohavethe
same rate
b
.
ThedynamicmodelwassimulatedstochasticallybytheGillespieal-
gorithm(
31
),usingastheinitialconditionagivennumberofuninfected
cells(
U
0
),founderviruses(
V
0
),andnoinfectedcells.Thefoundergroup
consistedofvirionswithamonoclonal(WT)genotype.Simulationspro-
ceededbydynamicallyupdatingthelistofgenotypesandcorresponding

amino acid sequences encountered as the viral population became more

diverse(
28
),insteadofenumeratingallpossiblesequences,whichbecome
exponentiallynumerousevenforsmall
L
a
.
Forcomparison,wealsoconsideredanextendedmodelforadaptation
inanimalhostswithimmuneresponseforwhichequation3isreplacedby
I
n

s
I
n

T
n
(stimulation)(6)
I
n

T
n

c
T
n
(killing)(7)
T
n

b
0 (clearance)(8)
where
T
n
denotes a cytotoxic T lymphocyte speci˚c to genotype
n
, stim
-
ulatedwithrate
s
bythepresenceofinfectedcellsandcapableofkilling
themwithrate
c
.
Serial-passageprotocol.
Tomodelserialpassages,weimplementeda
stochastic simulation algorithm where the monoclonal founder group

underwentagrowthprocessfora˚xedamountoftime(

),andthere-
sultingquasispecieswasrandomlysampledtoformanewpolyclonal

foundergroupforthenextroundofpassage.Allfreevirionsweresam-

pled, while infected cells were excluded. A given virion has a probability

f

V
0
/V

1tobesampled,suchthatoneroundofgrowthproducing
populationsize
V
isfollowedbythenextroundwithaninitialnumber
fV
ofviruses.Thisprocedureleavesthesetoffrequenciesofgenotypespres-
WooandReifman
1040
jvi.asm.org
JournalofVirology

entbefore and afterthe bottleneck eventroughlythe same.Strains with
smallfrequencies,however,oftendisappearafterabottleneckevent(ﬁex-

tinctionsﬂ).
Simulationunderrandomlandscapes.
We˚rstperformedtwodif-
ferentclassesofsimulations:thoseinwhichthefoundervirusesareal-

readywelladaptedtothehostandthosewherethefoundergroupfacesa

novel host environment. In both cases, a key input to the model was the

˚tnessfunction
r

,forwhichwe˚rstadoptedrandom˚tnesslandscapes:
the˚tnessfunctionwasmodeledasaGaussianrandomvariablewith
mean
	
r



r
0
exp(

d

/

)andstandarddeviation

,where
d

isthe
distanceofsequence

(aminoacidsitesthataredifferent)fromarefer-
ence with ˚tness
r
0
, and

is a characteristic distance of the ˚tness decay.
Weused

1aminoacid(aa)and

0.1unlessotherwisespeci˚ed.The
choiceofreferencesequence(
d


0)distinguishesthetwoscenarios
withoutandwithadaptations:intheformer,thereferencesequenceco-
incideswiththefounderWTsequence,whileinthelatter,theyaredis-

tinct.Thereference(i.e.,theﬁmost˚tﬂ[MF]sequence)wastakenasa

randomnucleotidesequenceofacertainlength,translatedintotheamino

acidsequence,andassignedthe˚tness
r
0
.Theresultsshownwereob
-
tainedtypicallybyaveraging

100differentrealizations,eachsimulated
withdifferentrandomsequencesunderthegivenparametersetand

length/distancespeci˚cations.Dependenceonthesamplesizeofrealiza-

tionsindicatedrapidconvergencewithinlessthan

100realizations,with
consistentlylargevariances(datanotshown).
Simulationsofpassageswithoutadaptationwerestartedwiththese
MFsequencesasthefoundergroup.Forsimulationsofpassageswith

adaptation,WTandMFsequencesineachrealizationweregeneratedby

˚rstassigningtheWTrandomlyandthensubsequentlymutatingitwitha


of0.1untilasequencewiththedesiredaminoaciddistancewasob-
tained.ThelattersequencewasdesignatedtheMFsequence.
Theadaptationprocessstudiedinthisworkwasde˚nedbytheexplo-
ration of sequence space by the viral population during passages starting

fromafounderpopulationwithasuboptimal˚tness(WT),leadingtothe

discoveryanddominanceoftheMFsequence.Simulationswereper-

formedwiththegenomicsegmentlength
L
a

d
,where
d
isthedistance
betweenWTandMFsequences.Asacharacteristicmeasureoftheef˚-
ciency of adaptation, we probed the time required (ﬁjumping timeﬂ) for

theMFsequencetobediscoveredanditsfrequency(calculatedbysum-

mingthenumbersoffreevirionsandinfectedcells)toreach50%ofall

sequences.Theinverseofthistimewasde˚nedastheﬁjumpingrateﬂ(
J
),
a stochastic quantity with a wide distribution including
J

0, which
correspondstocaseswherethetrajectoryneverreachedtheMFsequence.

Themaximumsimulationtimewassetsuchthatitwasmuchlongerthan

thetypicaljumpingtimesfortrajectoriesthatdidreachMF.Realizations

thatbecamestuckwithanonzerodistancetoMFexhibitedstationaryMF

frequenciesof

50%(oftenzero)beyondthetimemaximumandwere
countedashavingazerojumpingrate.
InferenceofÞtnesslandscapes.
Tomodelspeci˚cevolutionaryadap-
tationsmoredirectlylinkedtoexperimentalstudies,wederivedempirical

˚tnesslandscapesofHAsequencesforin˜uenzaH5N1virusesandused

themasinputtoourstochasticmodel.Forthe˚tnessinference,wead-

optedamodi˚edversionofthedirectcouplinganalysisalgorithm(
32
,
33
)
andusedittoinferthe˚tnesslandscapeofamodelin˜uenzaHAprotein

segment.Inthisinferenceprocedure,oneemploysanempiricalfunc-

tionalformofthestationarydistributionofgenotypesthatmaximizesits

entropyandinferstheparametersinthisexpressionusingMSAs.We

downloadedin˜uenzavirussequencesetsfromtheNCBI(
35
):forH5,we
used2,085full-lengthHAsequencesofH5N1,excludinglaboratory

strains,whileforH3,weused4,113full-lengthHAsequencesofH3

strains.
For inference, the MSAs were used to derive the empirical single-site
andtwo-siteaminoaciddistributions,
f
i
(

)and
f
ij
(

,

),eachgivingthe
frequencyofaminoacid

onsite
i
andthejointfrequencyof

and

on
sites
i
and
j
,respectively.Apriordistribution
p
0
(

)withacount
n
0
was
usedinfrequencycalculations,suchthatthetotaleffectivenumberof
sequenceswas
n
0

N
s
,where
N
s
istheactualsequencecount.Forthe
priordistribution
p
0
(

),weusedthefrequencyvaluesfromtheJones-
Taylor-Thorntonmatrix(
36
),augmentedby
p
0

0.01forthegap,and
renormalizedthe21values.Thepriorcount
n
0
valuesusedwere3,000and
4,000forH5andH3,respectively.Thesetofempiricaldistributions,
f
i
(

)
and
f
ij
(

,

),werethenmatchedtothemaximum-entropyexpressionof
theprobabilityofasequence
q

(

1
,...,

La
),
p
(
q
)

exp(
r
q
/
r
s
),where
r
q


i
h
i
(

i
)


i

j
C
ij
(

i
,

j
) (9)
wasobtainedusingthemean-˚eldapproximation(
33
),wherethematrix
inverseof
f
ij
(

,

)givestheparameters
C
ij
(

,

)afterexcludingareference
aminoacid,whichwetookasAla,fromtheargumentlist.Inourapplica-
tion,thefrequencydataforthe
L
a

4minigenome(103,156,222,and
224 [H5 numbering], identi˚ed as the locations of key mutations in HA
duringH5N1adaptationinferrets[
6
])wereusedtoinfertheparameter
set
C
ij
(

,

)and
h
i
(

).Theinferenceonlydetermined˚tnessvaluesupto
anadditiveconstant(inadditiontothereference˚tnessvalue
r
s
),which
we chose such that genotypes neighboring the MF sequence had suitable
replicationrateswithinthestochasticmodel.
Simulationofinßuenzavirusadaptation.
WeusedtheinferredH3
˚tness landscape as an input to the stochastic simulations of H5 WT

adaptationinmammalianhostenvironments.Eachsimulationwas

startedwiththeWTgenotypeCATACACAAGGA(HTQG)ofH5N1with

adifferent randomnumberseed, andeachmutant generatedinthe sim-

ulationswasdynamicallyassignedthe˚tnesscalculatedbytheinferred

˚tnesslandscapeparameters.Thereference˚tnessvaluewassetas
r
s

1
day

1
.TheWTandMF(SAQG)˚tnessvalueswere4.9and21.7(inunits
of
r
s
),respectively.ThissetupmimicstheadaptationofH5underthe
selectiveenvironmentsnativetoH3strains.
RESULTS
Stochastic model.
The basic model of stochastic virus evolution
usedinthisstudyinvolvedthefollowingsetofspecies:uninfected

hostcell
U
,avirionwithgenotype
n
(denotedby
V
n
),andacell
infectedwiththevirion
I
n
.Theyinteractedaccordingtothefol
-
lowingsetofevents:aninfectionofahostcellwithrate
a
,arepli-
cationeventwhere
I
n
produced
V
m
withreplicationrate
r
n
and
mutationprobability
Q
mn
(afunctionofthemutationrate

,de
-
˚nedastheprobabilityofmakingasubstitutionerrorpernucle-

otidesiteperreplication),andtwoadditionaleventsinwhichan

infectedcelldiesandavirionisclearedwithrate
b
(seeMaterials
andMethods).Weadoptedthesamerateforthelasttwoprocesses

forsimplicity.Theclearanceofvirusesmaybeviewedasre˜ecting

theeffectofanyinnateand/oracquiredimmuneresponsespres-

entifpassagesoccurinliveanimalsorunspeci˚eddecaymecha-

nisms in cell cultures.
Ifthemutationrate

iszero(
Q
mn

1if
m

n
and0other
-
wise),thecontinuumapproximationtoequations1to4becomes

equivalenttothetargetcell-limitedmodelusedbyBaccametal.

(
20
)andPaweleketal.(
37
)tostudythekineticsofin˜uenzaA
virusinfection.Wecomparedthefulldiscretestochasticsimula-

tionwiththeoutcomesofthecontinuumdifferentialequation

representationandfoundthatthelatterseverelyoverestimated

thespeedofadaptation(exploredindetailinthefollowingsub-

sections)becauseitassignednonzerofrequenciestoallgenotypes

viaequation5atalltimes
t
of

0(datanotshown).Onlyfora
simpli˚edmodelwith
L

3nt(64possiblegenotypes)andan
arti˚cially high mutation rate

of

0.1 was the difference be-
tweenthetwomethodsrelativelysmall.As

decreased(orcon-
verselywithincreasing
L
,whichincreasesthetotalnumberof
genotypesexponentiallywhilethepopulationsizeremainssmall),

thepopulationdynamicsquicklybecamedominatedbythe˚nite-
ModelingVirusAdaptationunderSerialPassages
January2014Volume88Number2
jvi.asm.org
1041

sizeeffects:stochasticsimulationsofthefulldiscretemodelpre-
dictedlongwaitingtimesforthediscoveryofMFgenotype,while

thecontinuumapproximationyieldedarapidriseinMFfre-

quency.Therefore,torealisticallymodelthetime-dependentad-

aptationbehaviorofviruspopulations,itisimportanttotakeinto

account the discrete nature of population sizes.
Viralgrowthcurve.
Thetypicaltime-dependentbehaviorof
virusgrowthanduninfectedcelldepletionforasinglecellculture

orsinglehostisshownin
Fig.1A
,alongwiththeexperimentaldata
ofin˜uenzaAvirusH1N1infectionkineticsfromreferences
20
and
38
.Thetotalviruscount
V
inourmodeloutputwasassumed
tobeproportionaltotheexperimentallymeasuredviraltiters.For

comparison, we assumed an empirical scaling factor such that 1

viruscountcorrespondedto150%tissuecultureinfectivedose

(TCID
50
)/ml.Duringsimulations,theinitialclonalfoundervirus
group(
V
0
virions)underwentashortperiodofclearancebefore
thetargetcells(initially
U
0
)becameinfectedappreciably.Theviral
titerbegantoriseasinfectionandreplicationoccurred,whereas
thenumberofuninfectedcellsdecreased.Thegrowthstopped

whenthetargetcellsbecamedepletedandwasfollowedbygradual

celldeathandvirusclearanceprocesses.Theparametervalues

werechosentoobtainagoodagreementinviruscountbetween

thesimulationandtheexperimentaldata.Thevalueof
a
primarily
affectedtheshapeoftheinitialriseinviruscount,withlarger

valuesleadingtoa˜attercurveupto

2days(initialvirions
rapidlyconsumedbyinfection)followedbyasharperincrease

(infected cells start producing copied virions). The value of
b
af-
fectedthedecayrateaftersaturation,withlargervaluesleadingto

a faster decrease in virus count.
Thisoverallbehavioroftotalspeciescount(uninfectedcells
andvirusesofallgenotypes)shownin
Fig.1
wasqualitatively
similartothoseobtainedwithakineticmodelbyBaccametal.
(
20
).However,thediscretestochasticmodelprovidedpreviously
unavailableandrealisticviewsofthegenomicdiversi˚cationpro-

cessaccompanyingthisgrowth(
Fig.1B
).Theresultsshownin
Fig.
1
wereobtainedbyaveragingovermanyexplicitrepresentations
of
L
a

3aa(
L

9nt)genomicsegmentswithrandomsequences
and decreasing ˚tness distributions of mutants around the WT
withincreasingdistance(seeMaterialsandMethods),achoice

that has been empirically validated using experimentaldata (
28
).
Thenumbersofdistinctnucleotideandaminoacidsequences

increasedwiththeviraltitergrowth,reachingapeaktogetherwith

theviruscount.Thecelldeath/clearancephase(time,3to8days)

ledtoarestorationofthemonoclonalpopulation,whichwasdue

totherelativelylowmutationrate

of1

10

5
,closetotypical
valuesestimatedforRNAviruses(
39
,
40
).Themaximumnum-
bersofgenotypesshownin
Fig.1B
,

25ntsequences(and

17aa
sequences),infact,areclosetothenumberofallpossiblesingle

mutantsplustheWT,1

3
L

28ntsequences,whichsuggests
thatwiththegivenmutationratevalue,singlemutantsdominated

thewithin-hostquasispeciesforsmallgenomicsegmentsof
L
a
ontheorderof1aa.Insummary,inadditiontoillustratingqual-
itativebehaviorofviralgrowthsinagreementwithexperimental

trends,ourmodelalsorevealedthatgenomicdiversi˚cationis

maximal when the population size grows rapidly.
Serialpassages.
Weextendedthebasicstochasticmodelgiven
byequations1to4tosimulatethetypicalgrowthandevolution-

arydynamicsencounteredinexperimentalserialpassages.Inthis

protocol,simulationsofsingle-hostgrowthasshownin
Fig.1
wereterminatedatacertaintime(passageinterval

,chosennear
theviralcountmaximum),andthequasispeciespopulationwas

sampledwithequalprobabilityforallvirionspresenttoproducea

foundergroupofvirionstoinfectfreshnewtargetcells(withthe

same
U
0
)forthenextroundofthepassage.Theﬁbottleneckfac
-
torﬂ
f

1,de˚nedastheratiooftheinitialviralpopulationsizeof
aroundtothe˚nalviralpopulationsizeofthepreviousround

(andcontrolledbyvaryingthefoundergroupsize
V
0
),quanti˚es
thestrengthofselectionpressureexertedonviruses:smaller
f
values cause only the most dominant genotypes (higher frequen-

cies)tosurvivethesebottleneckevents.Thesurvivalprobability

thereforedependsonhowef˚cientlyagivenstraininfectsthe

limitednumberoftargetcellstoreplicateincompetitionwith

others.
We˚rstexaminedthesimplercaseinwhichtheviralpopula-
tionwasalreadywelladaptedtothetargetcellenvironment,and

nosystematicevolutionarydriftinsequencespacewasexpected.

Thissituationwasmodeledbyusinga˚tnessfunctioncentered

aroundtheWT(thegenotypecorrespondingtothefounder

groupofthe˚rstpassage).
Figure2
showsthetypicaltime-depen-
dentbehavioroftheviruspopulationsizeandgenomicdiversity.

Thetotalviralcountrepeatedthegrowthpatternafterabottle-

neckeventwiththepassageperiod

of3days,withtheinitialvalue
atthebeginningofaroundkeptconstantas
V
0
.Thesmallervalue
ofdeath/clearancerate
b
insimulationsshownin
Fig.2
compared
to
Fig. 1
resulted in ˜atter plateau regions near the viral count
peaks,wherethegenomicdiversitywasmaintainednearthesin-

gle-mutantmaximumlevelof

28ntsequences.Althoughthe
bottleneck selection cuts this diversity downto

1 (WT) inthis
particularcase,wefoundtheinitialnumberofstrainsateach

roundtovarydependingon
f
,approachingthemaximumfor
larger
f
values.
Thecombinedfrequencyofmutantsshownatthebottompart
024
6
8
10
0
10
2
10
4
10
6
Viral titer / Cell count
Influenza A
Virus count
Uninfected cell
024
6
8
Time post infection (days)
10
0
10
1
No. of strains
nucleotide
amino acid
A
B
FIG1
Viralgrowth,hostcellinfection,andwithin-hostdiversi˚cationdy-
namicspredictedbythestochasticmodelforthefollowingparametervalues:

L
a

3aa,
V
0

1

10
3
,
a

1.0

10

3
day

1
,
b

3.0day

1
,
r
0

6.0day

1
,

1.0

10

5
,and
U
0

1

10
6
.(A)Viraltiteranduninfectedcellnumber
U
0
.Symbolsrepresenttheexperimentaldatafromreferences
20
and
38
,plot
-
tedassumingascalingfactorof1viralcountper1TCID
50
/ml.(B)Total
numbersofgenotypes(nucleotideandaminoacidsequences)asafunctionof
time.
WooandReifman
1042
jvi.asm.org
JournalofVirology

of
Fig.2
indicates that during the initialgrowth process in a given
passage round, the rapid population growth with mutations led to

asharpincreaseindiversity.Then,asthetargetcellswerede-

pleted,duetoanincreaseinviralpopulation,themutantfre-

quencydecreasedagainafter

1.5days.Becauseinthiscasethe
˚tness distribution was centered at the WT, the viral population

revertedtotheWT-dominantstructuresaftereachmoderatedi-

versi˚cationstageunderselection.Weexaminedthetrendinthe

totalnumberofgenotypespresentaftertheendofeachpassage

roundasafunctionofpassagenumberupto30passagesand

con˚rmedthatunderthiscondition,eachpassageroundwassta-

tisticallyindependentofthepreviousround(datanotshown).In

summary,ourmodelallowsforasimpledescriptionofrepeated

bottleneckeventsunderserialpassages.Iftheinitialpopulationis

alreadywelladaptedtothehostenvironment,theselectionevents

did not affect the quasispecies structure appreciably.
Adaptation.
Moretypicalinexperimentalserialpassagesisthe
situationinwhichtheWTisexposedtoanewhostenvironment

inwhichits˚tnessisnotoptimal.Evolutionarydynamicsthen

exhibitanadaptationprocesswheresystematicdriftstowardmore

˚tgenotypesoccurwithinacharacteristictimescale,whichwe

refertoasthe(species)ﬁjumpingtime.ﬂInourmodeling,the

adaptationprocesswasde˚nedastheexplorationofsequences

neartheinitialWTduringpassagesandthediscoveryofmore˚t

genotypes leading to the increase in their frequencies. We adopted

˚tnessdistributionswhereaWTwaschosenatacertaindistance
d
fromtheMFgenotype.WefoundthisdistancetoMFtobethe

dominantfactorin˜uencingtherelativeprobabilityofadaptation.

Thejumpingtimewasde˚nedasthetimerequiredsincetheini-

tiationofpassagesfortheMFgenotypetobediscoveredandforits

frequency to reach 50% of the viral population.
Figure3A
showstypicalevolutionarydynamicsofsuchanad-
aptationprocessfromoursimulationsaveragedover100realiza-

tions,where
d

2aaandotherparametervalueswerechosento
bestillustratethetypicalbehaviorinsimulationsundertheseset-

tings.Duringtheearlierroundswherethepopulationwasdomi-

natedbytheWTwithalower˚tness,thetotalviruscountreached

wasrelatively smaller.Itgradually increased with theincreasing
numberofpassagesasmutantswithhigher˚tnessvaluesappeared
anddisplacedtheWT.
Figure3B
showsvariationsofthemean
distancetotheMFandthefrequencyoftheMF.Themeandis-

tance roughly decreased monotonically with the number of pas-

sages,whereastheMFfrequencydidnotincreaseappreciably

fromzerountilthethirdpassageround:theadaptationattheearly

stageprimarilyarosefrommutantsotherthantheMF,whichonly

appearedafteraconsiderableperiodofﬁsearchﬂinthesequence

space.BoththeapproachtotheMFandtheincreaseinMFfre-

quencyoccurredingraduatedﬁstepsﬂwithmostchangesconcen-

tratedintheearlyphaseofeachpassageround,whereactive

growthoccurredandcompetitionamongstrainswasmostsevere.
The late-stage limiting values of the mean distance and fre-
quencyaftermanyroundsofpassageswerefairlydistantfromzero

andone,respectively.Wefoundthatthisfeaturewasprimarily

due to the sizeable presence of realizations in which evolutionary

dynamicsgotﬁstuckﬂinmutantsdistinctfromtheMFbutwith

˚tnessvalueslargerthanthatofWT,ratherthanaconsistent

convergencetotheseaveragelimitingvalues.Thisfeaturecanbe

seenmoreclearlyin
Fig.4
,whichshowsthedistributionofthe
jumpingrate
J
,de˚nedastheinverseofthejumpingtime.The
distributionismultimodal,withbroadpeaksatlarger,˚niterates

andanonzeroprobabilityofzerorate.Thelatter,morepro-

nouncedfor
d

2aa(
Fig.4B
),canbeattributedtothetopological
structureofthegeneticcode:transitionsviasubstitutionerrors

betweenasigni˚cantnumberofpairsofaminoacidsrequiremul-

tiple mutations, making them highly unlikely. A population can

becomedominatedbyagenotypeclosetotheMFindistancebut

notdirectlyaccessible.The˚nestructureofthedistributions

shownin
Fig.4
re˜ectsthecharacteristicsofpassagedynamics:the
rightmostclusterofpeaksin
Fig.4A
(
d

1aa)correspondsto
casesinwhichtheMFfrequencyexceeded50%duringthe˚rst

passagecycle,theclustertoitsleftthesecondcycle,andsoon.For

a
d
of2aa,theprobabilityofjumpingduringthe˚rstpassagecycle
wasvirtuallyzero(
Fig.4B
).Thegapsbetweentheseclustersap-
03
6
912
15
18
Time (days)
10
-4
10
-2
10
0
10
2
10
4
10
6
Populations
Viral count
No. of strains (nt)
No. of strains (aa)
Mutant frequency
FIG2
Timedependenceofviralpopulationsizeanddiversityoverserial
passagesimulationswithoutadaptation.TheWTandMFcoincideinthese-

quencespace.Theparametervalueswerethesameasin
Fig.1
exceptthat
b

1.0day

1
and

3days.
10
0
10
2
10
4
10
6
Populations
Viral count
No. of strains (nt)
No. of strains (aa)
036912
15
1821242730
Time (days)
0.0
0.5
1.0
1.5
2.0
Distance / Frequency
MF frequency
Mean distance
A
B
FIG3
Timedependenceofpopulationsizeanddiversity(A)aswellasmean
distance to the MF sequence and the frequency of the MF (B). Parameter values

wereasfollows:
L
a

d

2aa,
V
0

1

10
4
,
U
0

1

10
6
,
a

1.0

10

3
day

1
,
b

1.0day

1
,
r
0

20day

1
,

1.0

10

5
,and

3days.
ModelingVirusAdaptationunderSerialPassages
January2014Volume88Number2
jvi.asm.org
1043

pearedbecauselarge-scalechangestofrequencydistributionoc-
curmostlyduringtheearlygrowthstagewithineachround(
Fig.
3B
). The jumping rate correlates with the general likelihood of
observingagivenadaptationduringpassages.Tosupportthis

conclusionquantitatively, we˚ttedthedistributionsin
Fig.4
us-
ingmaximum-likelihoodestimationtothefunctionalformofa

sumofnormaldistributionswiththeamplitude,mean,andstan-

darddeviationsasparameters,shownin
Fig.4
asdashedlines.The
jumpingtimeinunitsofpassagenumbersforthemodeswith

signi˚cantamplitudes(thepeaksin
Fig.4
fromrighttoleft)were
1.2,2.1,and3.1for
Fig.4A
and
2
.1,3.1,4.1,and5.1for
Fig.4B
,
con˚rmingthatjumpingeventsmostlyoccurnearthebeginning

ofeachpassagecycle.Insummary,themodelallowedforquanti-

tativecharacterizationsofthespeedofadaptationintermsofthe

timerequiredforahighly˚tgenotypetoappearanddominatethe

quasispecies population under passages.
Variationsofjumpingrate.
Weexaminedthedependenceof
jumpingrate
J
,whichisameasureoftherelativeprobabilityof
observingacertainadaptationfromaWTtoaMFgenotypedur-

ing passages, on mutation rate

(
Fig. 5
). For a given distance
d
betweentheWTandMF,thejumpingratemonotonicallyin-

creasedwithincreasing

.Thelargevarianceinjumpingrate
showedlittlesample-sizedependenceandre˜ectedthecontribu-

tion of pathways inaccessible to the MF genotype in sequence

space,aswellasthemultimodalstructureofitsdistributionover

theinitialphaseofmanypassagecycles(
Fig.4
).Therelativeam-
plitudesofnormaldistributions˚ttedtothedatain
Fig.4A
and
B
weredistributedevenly,withproportionsof0.5,0.3,and0.1and

0.2, 0.2, and 0.2, respectively, for the ˚rst 3 main peaks from the

right.Toexaminetheeffectsofheterogeneityinsubstitutionrates

atdifferentsites,whichwouldbecomemoreimportantforlonger

sequences,wealsoconsideredthecasewherethemutationrate

at each nucleotide site was sampled froma gamma distribution

(
41
).Foran
L
of6nt,thesiteheterogeneitydidnotaffectthe
jumpingrateappreciably(datanotshown).Itseffect,however,
maybecomestrongerforlongergenomicsegments,forwhich

deep-sequencingdataofviralgenomes(
42
)couldbeusedtoas-
sign site and nucleotide-dependent substitution rates.
While jumping rate values became statistically similar for dif-
ferentdistancesnear

of

10

3
(
Fig.5
),theydifferedwidelynear
theexperimentalrangeofmutationratesof

10

5
,where
J
de
-
creasedexponentiallywithincreasing
d
,reaching
J
of

10

2
day

1
fora
d
of3aa,orajumpingtimeof

100days(33passages).
Fromtheresultsshownin
Fig.5
,wemayinferestimatesforthe
typical number of passages (of 3 days for each round) that would

berequiredunderatypicalmutationrateof

10

5
toarriveat
andjumptoanMFsequence:3,6,and33passagesfor1-,2-,and
3-aa distances, respectively.
Thedependencesofthejumpingratewithotherphysicalpa-
rametersareshownin
Fig.6
.Thehostcellnumber
U
0
determines
theviralpopulationsizereachedwithineachpassageround.The
jumpingratemonotonicallyincreasedwithincreasing
U
0
,satu
-
ratingnear

0.1day

1
(
Fig.6A
).Thebottlenecksize
V
0
fora
given
U
0
representsthestrengthoftheselectionpressure,deter
-
miningthebottleneckfactor
f
.Althoughat˚rstthejumpingrate
increasedwithincreasing
V
0
forsmall
V
0
,itreachedamaximum
and began to decrease as
V
0
approached
U
0
(
Fig. 6B
). For small
V
0
,
more˚tmutantsfoundduringapassageroundfrequentlywere
lostbecauseoftheirlowfrequencies,whereasforlargeenough
V
0
,
theyusuallysurvivedthebottleneckselections.Theincreaseof
J
withincreasing
V
0
forsmall
V
0
thereforeisagradualattenuation
ofthe˚nite-sizeeffect.Fora
V
0
of

10
4
(or
f
of

10

2
for
V
of
10
6
),thestartingviralpopulationateachroundwassuf˚ciently
large,makingasmallerbottlenecksizemorefavorableforadap-
tation.
Thepassageperiod

affectsthejumpingrateprimarilyviathe
sizeandfrequencyofviralpopulationsatwhichbottleneckevents

occur.Theapproximateincreaseof
J
withdecreasing

(
Fig.6C
)
canbeexplainedbytheincreaseinthefractionoftimeapopula-

tionexperiencedstrongcompetitionviarapidgrowthduringeach

passage round (
Fig. 3
). If the period is too short (

1 day), this
growthphasebeginstobeinterruptedbybottlenecks,decreasing
J
again.Wefoundthejumpingrate
J
tobeinsensitivetovariations
Jumping rate (day
-1
)
Probability density
0.000.050.100.150.20 0.250.300.35
0
5
10
15
20
A
Jumping rate (day
-1
)
Probability density
0.000.050.100.150.20 0.250.300.35
0
20
40
60
80
100
B
FIG4
Jumpingrate(
J
)distributionsfromthesetsof10
3
realizationsusing
parametervaluesasin
Fig.3
fortwodifferentdistances:
d

1aa(A)and
d

2aa(B).Thedashedlinesshowmaximum-likelihood˚tstolinearcombina-

tionsofnormaldistributions.TheclusterofpeaksinpanelAcenteredata
J
of

0.3day

1
,0.16day

1
,0.11day

1
,and0.07day

1
correspondtojumping
events(MFfrequencyexceeding50%)duringthe˚rst,second,third,and
fourthpassagerounds,respectively.Thepeaksata
J
of0arisefromtrajectories
trappedatsequenceswithoutdirectsinglesubstitutionroutetotheMFse-

quence.
10
-6
10
-5
10
-4
10
-3
Mutation rate 
µ
10
-2
10
-1
Jumping rate (day
-1
)
d
 = 1 aa
d
 = 2 aa
d
 = 3 aa
FIG5
DependenceofjumpingrateonthemutationratefortheWT-to-MF
distancefrom1to3aa.Symbolsrepresentaveragesanderrorbarsrepresent1

standarddeviationover100realizations.Parametervalueswereasfollows:

V
0

1

10
5
,
U
0

1

10
6
,
a

1.0

10

3
day

1
,
b

0.1day

1
,
r
0

10
day

1
,and

3days.
WooandReifman
1044
jvi.asm.org
JournalofVirology

ininfectionrate
a
(
Fig.6D
).Thedependenceondeath/clearance
rate
b
wassimilar(
Fig.6E
),exceptwhen
b
increasedbeyond1
day

1
,wherecelldeathandclearancebegantoannihilatethe
growthphase.Finally,wevariedthecharacteristicwidthparame-
ter

of the ˚tness peak (
Fig. 6F
), where increasing

corresponded
tothe˚tnesspeakattheMFsequencebecomingbroader,which

sharply reduced the jumping rate: the probability for adaptation

wasreducedwhentheassociated˚tnessgaindecreased.Fora

of

1aa,˚tnessvaluesoftheWTanditsneighborsaretoosmallto
supportadaptation.Overall,theglobalpictureshownin
Fig.6
of
the dependence of the jumping rate
J
on different variables other
thandistancesuggeststhattheef˚ciencyofadaptationismuch

moresensitivetothecharacteristicsofbottleneckeventsthanhost

cell dynamics.
Effectsofimmuneresponse.
Forserialpassagesinanimal
hosts(
43
,
44
),theactionofinnateandadaptivehostresponses
mayaffectthedynamicsofadaptation.Toexaminesucheffects,

weconsideredanextendedmodelinwhichhostcellsinfectedwith

agenotypestimulateanimmunecell(cytotoxicTlymphocyte)

speci˚ctothegenotype,whichcankillinfectedcellswiththesame

genotype(equation3replacedbyequations6to8).Asimilar

implementationispossiblewiththeinclusionofantibodiesinter-

actingwithvirusesratherthaninfectedcells.Wefoundtheadap-

tationdynamicsoftheextendedmodel(
Fig.7
)tobequalitatively
similarto
Fig.3
,whichsuggeststhatthebasicmodelde˚nedby
equations1to4mayberegardedasaneffectivemodel indirectly
re˜ecting the selection pressure of immune response.
InßuenzaAvirusH5N1adaptation.
Togaininsightintohow
thegenericbehaviorofadaptationstatisticsexaminedasdescribed

aboveforrandomsequencesmanifestthemselvesinspeci˚cvirus

evolution,wehavemodeledtheavianin˜uenzavirusH5N1evo-

lutionaryadaptationinvestigatedinrecentexperimentalstudies

(
6
,
27
).Weobtained˚tnesslandscapesspeci˚ctoin˜uenzavirus
HAsequencesbyadoptingthedirectcouplinganalysis(
32
,
33
)for
˚tnessinference.Theinferred˚tnessparametersallowoneto

score ˚tness values of arbitrary genotypes that might be encoun-

teredduringevolutionaryadaptation.Wefocusedontheseg-

mentsofH5HAproteinidenti˚edasallowingtheH5N1virusesto

acquirethecapacitytoinfectviarespiratoryroutes:His103,

Thr156,Gln222,andGly224(H5numbering;wefocusedonthe

HAproteinonly,excludingGlu627ofthePB2proteinreportedin

theexperiment)(
6
).Uponserialpassaginginferretswithprein-
troducedmutationsQ222LandG224S,whichhadpreviously

beenshowntoenhancethebindingaf˚nityofH5HAtohuman

in˜uenzaAvirusreceptors(
45
),twoadditionalmutationswere
foundamongstrainsexhibitingthecapabilityofspreadingvia

airborne routes: H103Y and T156A.
Wetookthefourkeyresiduesatpositions103,156,222,and
224toformthemodelproteinsegmentof
L
a

4aa,forwhichthe
H5WTsequenceisHTQG.WeusedanHAproteinMSAofH5N1
sequencestoinferthe˚tnesslandscapeofthemodelsegment.
Figure8A
showsthe˚rst20genotypesrankedbytheir˚tness
valueswithinallpossiblesequences.ThesequenceHAQGhasa

˚tnesscomparable(slightlylarger)tothatoftheWT,re˜ecting

theprevalenceofAla156withinthesequenceset.Mostofthe

high-˚tnessmutantsinvolveasinglesubstitutionatposition156.

Thislandscapecorrespondstothenaturalenvironmenttowhich

H5proteinsarealreadywelladapted:avianhosts.Toobtainthe

analogous˚tnesslandscapeofHAinmammalianhosts,weused

anMSAofH3sequences.
Figure8B
showsthehighest-˚tnessge-
notypesofthecorrespondingpositions(110,160,226,and228in
FIG6
Dependenceofjumpingrateonotherparameters.(A)Numberofhost
cells
U
0
.(B)Bottlenecksize
V
0
,orthenumberofvirionsselectedateach
passageround.(C)Passageperiod

,orthetimedurationofeachpassage
round.(D)Infectionrate
a
.(E)Rate
b
ofinfectedcelldeathandvirusclear-
ance.(F)Fitnesslandscapepeakwidthparameter

oftheMFsequence.De-
faultvaluesofparametersotherthanthosevariedineachcasewerethesameas

in
Fig.5
,with
d

2aa,

1.0

10

5
,and

1aa.
FIG 7
Adaptationdynamicsoftheextendedmodelgivenbyequations1,2,
and4and6to8explicitlyincludinghostimmuneresponse.Parametervalues

werethesameasin
Fig.3
exceptfor
b

c

0.1day

1
and
s

0.01day

1
.
ModelingVirusAdaptationunderSerialPassages
January2014Volume88Number2
jvi.asm.org
1045

H3numbering),inadditiontothe˚tnessofH5WT,HTQG,
whichislessthan25%ofthe˚tnessvalueoftheMFsequence,

SAQG.Thelasttwopositionsonthesegmentarestilldominated

by QG as in H5: the enhanced ˚tness of H5 Q222L/G224S mutants

inH3environments,whicharecentstructuralstudylinkedtothe

cis
-
trans
changeofreceptoranalogs(
46
),isnotre˜ectedstrongly
inthenaturalH3populationswhencoupledmutationsaretaken

intoaccount.Wethereforemodeledtheadaptationofthe˚rsttwo

HApositionsbytakingthesequenceHTQGastheWTandSAQG

astheMFsequenceandsimulatingtheadaptationoftheWT

undertheH3˚tnesslandscapein
Fig.8B
.Intheseserial-passage
simulations,theWTnucleotidesequenceattimezerowas˚xed

(CATACACAAGGA)andthe˚tnessvaluesoftheappearingmu-

tantswereobtainedfromthecomputationallyinferredlandscape

parametersinsteadofbeingrandomlyassignedfromadistribu-

tion.
Typicalviralcountevolutionarypatternsweresimilarto
Fig.3
,
whiletheoutcomesoftheevolutionarytrajectoriesinthese-

quencespacevariedgreatlybetweendifferentrealizations,sug-

gestingthattheﬁruggednessﬂoftheempiricallyderived˚tness

landscapewithmultiplepeaksandvalleyssigni˚cantlyaffectedthe

adaptationprocess.Themajorityofthetrajectoriesdidnotreach

theMFsequencewithin

10
3
days(

300cycles),gettingtrapped
insomeofthegenotypeslistedin
Fig.8B
.Onetrajectorythat
reachedtheMFsequenceisillustratedin
Fig.9
:thesimulation
startswithamonoclonalWT(HTQG)populationattimezero.

TheT156Amutationalreadyappearsat3days,re˜ectingthelarge

jumpin˚tness(
Fig.8B
)aswellasthesimplicityofthenucleotide
substitutionrequired(A
¡
G).TheAla156isalreadydominant
after9days.Afterafairlylongperiodofexplorations,anewmu-

tant(RAQG)growsinfrequency(
t

99days),eventuallytaking
overataround150days.ItiscloselyfollowedbyLAQG,which

replacesRAQGat162days,and˚nallybySAQG,theMFse-

quence,at174 days.Afterwards,theMF frequencygrowsto

around0.99andremainsdominant,withthesubpopulationof

small minority mutants continually drifting around. The time-

dependentprogressionofthemostfrequentgenotypes(master

sequences;HTQG
¡
HAQG
¡
RAQG
¡
LAQG
¡
SAQG)cov-
ersthe˚tnesslandscape(
Fig.8B
)withasequentialincreasein
rank (251
¡
18
¡
14
¡
5
¡
1)and ˚tness(4.9
¡
12.3
¡
12.7
¡
13.4
¡
21.7),whilere˜ectingtheaccessibilityoftherequiredmu-
tations(
Fig.10
).Wecalculatedthemeanfrequenciesofdominant
genotypes(HAQG,QAQG,LAQG,andSAQG)asfunctionsof

timebyaveragingovermanytrajectories(
Fig.11
).Themeanfre-
quencyoftheMFsequenceSAQGof

10%withthetimescaleof

300daysre˜ectstheprobabilityofjumpingratherthantheac-
tualcompositioninindividualtrajectories:ifitoccurs,thegeno-

typeeventuallydominatesthepopulation(
Fig.9
).Insummary,
our results show that the basic stochastic model of adaptation can

becombinedwithsequence-basedempiricaldatatoyielddetailed

and experimentally relevant predictions of virus adaptation dy-

namics.
DISCUSSION
Our stochastic model of viral evolutionary dynamics during serial

passagesallowsforquantitativecharacterizationsoftheprobabil-

ity of observing systematic drifts in population structure and ad-

aptationstoanewhostenvironment.Thediscretestochasticrep-

resentationoftheviralevolutionarydynamicsisessentialto

realisticallycaptureadaptationsin˚nite-sizepopulationsdomi-

natedbyextinctionsofminorvariantsduringbottleneckevents,

whichcannotbedescribedusingviralcopynumbersascontinu-

ous variables.
Wemayviewtheserialpassageasanidealizedexperimental
setupwithwell-controlledvariablesdeemedimportantforevolu-

tionarydynamics.Theabilitytomodelpassagesquantitatively,

therefore,wouldprovideinsightsintoanalogouseventsoccurring

innaturalsettings,includingspeciesjumpsandoutbreaks(
5
).By
calibratingthemodelparametersusingcertainserialpassageex-

perimentaldata,onecouldapplythemodeltointerpretationsof

experimentsaswellasgenerationofpredictionsandtestablehy-

potheses.Thehostcellnumber
U
0
woulddependontheplating
densityforcellcultures,typically
U
0
of

10
6
orless,whereasfor
passagesusinglivehostanimalsitwouldbelargerandlessclear-
cut. The bottleneck size
V
0
, representing the number of virions
sampledaftereachpassageroundforinitiatingthenextround,
couldbereadilyestimatedbasedonthesamplingprotocolofthe

experiment.Appropriatevaluesfortheinfectionanddeathrates,

a
and
b
,couldbedeterminedby˚ttinggrowthcurvesasshownin
Fig. 1
, whereas the mutation rate

is known empirically for many
viral pathogens (
39
,
40
,
47
).
Inadditiontothesephysicalparameters,the˚tnesslandscape
HAQG
HTQG
HVQG
HSQG
HLQG
HEQG
HGQG
HIQG
HKQG
HDQG
HRQG
HPQG
HNQG
HQQG
HFQG
HYQG
HMQG
HHQG
HCQG
HWQG
A
0
5
10
15
SAQG
SSQG
STQG
EAQG
LAQG
AAQG
QAQG
GAQG
VAQG
TAQ G
KAQG
IAQG
DAQ G
RAQG
PAQG
FA Q G
NAQG

HAQG
YAQ G
HTQG
B
0
5
10
15
20
FIG8
FitnesslandscapesofanHAprotein4-aasegmentinferredfromMSA.(A)H5landscapederivedfromH5N1sequences.(B)H3landscapefromH3
sequences.Theheightofthebarsrepresentsthe˚tnessvaluesinunitsof
r
s

1.0day

1
.Theabscissashowsthelistofgenotypessortedwithdecreasingorderin
˚tness.InpanelB,therightmostbarshowstheH5WT,whichis251stinrank.
WooandReifman
1046
jvi.asm.org
JournalofVirology

andsequenceparametersarethekeyinputstomodelspeci˚ca-
tion.Inthiswork,we˚rstadoptedarandomsequencemodel

wherethegenomicsegmentunderconsideration(
L
a

1to3aa;
L

3to9nt)canexhibit˚tnessvaluesassumedtoberandom
variablesaroundamean˚tness,whichdecaysexponentiallywith

distancefromanMFsequence(seeMaterialsandMethods).This

choicere˜ectsboththetypicaldistributionofmutant˚tnessover

deleterious,neutral,andbene˚cialrangesandthepresenceofone

ormultiplepeaksinthe˚tnesslandscape.Thisassumptionhas

alsobeenpreviouslyvalidatedusingpublishedexperimentalchar-

acterizations of HIV-1 protease ˚tness (
28
,
48
).
Theconclusionsdrawnfromthispartofourstudypertainto
generalfeaturesoneexpectstoseeinobservationsofadaptation

processes common to many different viral pathogens: if we per-

formpassagesinhostenvironmentstowhichtheviruseshave

alreadybeenwelladapted,nosigni˚cantnewdriftinpopulation

structureoccurs(
Fig.2
).Inreality,however,perfectadaptation
wouldberareandonealmostalwaysexpectsdrifts,e.g.,towarda
more˚tgenotype2aaawayfromthestartingWT(
Fig.3
).The
speedofthisadaptationprocessischaracterizedbythetime(or

thenumberofpassagerounds)requiredforthepopulationto˚rst

discovertheMFsequenceandthenbecomedominatedbyit.The

jumpingrateisthemeaninversetimeofthisdiscovery/growth

process.
Themultimodaldistributionofjumpingratesshownin
Fig.4
revealsanimportantsignatureofthetopologyof˚tnessland-

scapes(
49
)constrainedbythegeneticcode:ifwevisualizethe
networkofaminoacids,whereedgesdenotesinglesubstitutions

(seeFig.S5inreference
28
and
Fig.10
),anevolutionarypath
wouldfrequentlygetstuckingenotypeswithaminoacidse-

quenceswithsigni˚cantlyhigher˚tnessthantheWTbutwithout

adirectaccesstotheMF.Wethusexpectthatthereisalwaysa

nonzeroprobabilityforacertainevolutionaryadaptationpath-

waytoneverreachahigh-˚tnessﬁtargetﬂgenotypeevenwhenitis
HTQG
HAQG
RTQG
HIQG
PTQG
A: t = 3 days
3e05
1e04
1e03
1e02
1e01
5e01
HAQG
HTQG
RAQG
QAQG
PAQ G
B: t = 9 days
3e05
1e04
1e03
1e02
1e01
5e01
HAQG
RAQG
NAQG
QAQG
YAQ G
C: t = 99 days
2e05
1e04
1e03
1e02
1e01
5e01
RAQG
HAQG
LAQG
NAQG
SAQG
D: t = 150 days
2e05
1e04
1e03

1e02
1e01
5e01
LAQG
RAQG

HAQG
NAQG
SAQG
E: t = 162 days
2e04
1e03
1e02
1e01
4e01
LAQG
RAQG
SAQG
HAQG
NAQG
F: t = 168 days
1e02
1e01
6e01
SAQG
LAQG
RAQG
HAQG
NAQG
G: t = 174 days
2e04
1e03
1e02
1e01
8e01
SAQG
LAQG
RAQG
SEQG
SSQG
H: t = 180 days 
1e05
1e04
1e03
1e02
1e01
9e01
SAQG
RAQG
STQG
GAQG
NAQG
I: t = 609 days
2e05
1e04
1e03
1e02
1e01
9e01
FIG 9
Time evolution of quasispecies composition during the H5-to-H3 adaptation of the model in˜uenza virus segment, simulated under the empirically
inferred˚tnesslandscapeof
Fig.8B
.PanelsAtoIshowthesequentialsnapshotsateachtimeinstance(immediatelyafterapassagecycle),listing˚vegenotypes
withthehighestfrequencies(showninlogarithmicscale).Theparametervalueswereasfollows:
V
0

1

10
4
,
U
0

1

10
6
,
a

1.0

10

3
day

1
,
b

1.0day

1
,

1

10

5
,and

3days.
ModelingVirusAdaptationunderSerialPassages
January2014Volume88Number2
jvi.asm.org
1047

close by in sequence space. This feature can be interpreted as a
consequenceoftheﬁruggednessﬂofthe˚tnesslandscape,leading

tofrequenttrappingofevolutionarydynamicsofadaptingorgan-

isms (
50
).
Thejumpingrate
J
dependssensitivelyonthedistancefrom
WT to MF sequences (
Fig.5
);for

of

10

5
,
L
a
values from 1 to
3aayield
J
valuesdecreasingfrom 10

1
day

1
to10

2
day

1
,with
thelattercorrespondingtojumpingtimesof

100days,whichis
beyondtheupperlimitoftypicalpassagedurations.Recentexper-

imentaldemonstrationsofspeciesjump-capablemutationsin-

ducedbyserialpassagesareconsistentwiththisobservation:

Sheahanetal.usedserialpassagesincellculture(
12
)toprobethe
adaptationspresumedtohavebeenresponsiblefortheSARS-CoV

outbreakin2004,withthespeciesjumpfrombatstohumansvia

palmcivetsashostspecies.TheyengineeredaSARS-CoVepi-

demicstraininwhichtheSproteinreceptor-bindingdomainwas

replaced by its counterpart in the civet strain (the WT) and pas-

sageditinhumanairwayepithelialcells.Onlyaftertheymanually

introducedtotheWTakeymutationpreviouslyknowntosignif-

icantlyaffectreceptorbinding(
51
)didserialpassagesupto22
daysproducestrainswithsigni˚cantlyenhancedgrowthandrep-

licationinhumancells.Sequencingoftheseadaptedstrainsre-

vealed two additionalmutations in the receptor-binding domain

thataroseduringpassages(
12
).Thisobservationagreeswithour
conclusionregardingthelikelihoodofspeciesjump-capablemu-

tationsspontaneouslyarisingduringserialpassages:withphysi-

callyreasonableparametersets,more˚tgenotypespresentinthe

sequencespacerequiringmutationsuptoa
d
of2aacaneasilybe
discoveredwithintimeperiodsof

20days(jumpingrate
J

5

10

2
day

1
in
Fig.5
),whilethosefurtherawaywillbemuchless
likely to appear.
Toexaminemorespeci˚cinstancesofsuchadaptationpro-
cesseswithdirectrelevancetoexperimentalinvestigations,we

specializedthemodeltotherespiratoryinfectionadaptationof

H5N1 under serialpassages and simulated the recent gain-of-

functionexperimentsbyHerfstetal.(
6
)usingourstochasticsim-
ulationalgorithm.Inthisexperiment,passagingWTH5N1in

ferretsdidnotyieldadaptation,butafterthreemutationsprevi-

ouslyknowntoplayimportantrolesinin˜uenzavirusinfection

wereintroduced,10passageroundsproducedstrainscapableof

respiratoryinfectionbetweenferrets.Analysesofsequencesre-

vealedtwokeymutationsthataroseduringpassages.Thelarge

number of sequences currently available for in˜uenza allowed us

todetermine˚tnesslandscapesusingacomputational˚tnessin-

ferenceprocedure.Bychoosingdifferentsequencesetsforthis

inference (H5 and H3 in
Fig. 8A
and
B
, respectively), we obtained
landscapesspeci˚ctodifferenthostenvironmentstowhichaviral

populationadapts.ThefouraminoacidsiteswithinHAchosen

forinvestigation(His103,Thr156,Gln222,andGly224)arethose

previouslyshowntoexhibitadaptivemutationsenablingrespira-

tory-routeinfectioninexperiments(
6
).Intheexperiments,with
twomutations(Q222L/G224S)preintroduced,serialpassaging

producedadaptedstrainswithtwo additionalmutations(H103Y/

T156A).The˚rsttwomutationsdidnotfeatureprominentlyin

theH5orH3˚tnesslandscapes(
Fig.8
),re˜ectingtheengineered
natureofthesemutationsthatcompensatefortheinef˚ciencyof

H5bindingtomammalianreceptors(
46
).Ourchoiceoftaking
the WT and MF genotypes in our simulation as HTQG and SAQG,

respectively,eachthe(near)highest˚tnesssequencesinH5and

H3landscapes,respectively,mimicsthesituationwhereanH5

strainundergoesadaptationwithneitherthecompensatorymu-

tationsQ222L/G224Snorthehelpofcollectivechangestoother

sites.
Theevolutionarypathdescribedin
Fig.9
illustratesanexample
ofhowtheadaptationprocesscouldunfoldinthesequencespace

under the selective forces of realistic ˚tness landscapes.The series

of changes to the highest-frequency genotypes within the quasi-

species(HTQG
¡
HAQG
¡
RAQG
¡
LAQG
¡
SAQG)aswell
astheirtimingsre˜ectboththefeaturesofthelocallandscape

visitedandthemutationalconstraintsimposedbythegenetic
SS
ST
YA
DA
IA
AA
GA
SA
LA
FA
VA
NA
TA
KA
EA
HA
HT
QA
RA
PA
FIG10
In˜uenzavirusgenotypenetworkcorrespondingtothe˚tnessland-
scape in
Fig. 8B
. Nodes represent the genotypes (˚rst two amino acids) and
edges connect pairs for which there exists at least one single-nucleotide muta-

tionseparatingthetwonodes.Thearrowheadsontheedgesre˜ectthedirec-

tionof˚tnessincreases(
Fig.8B
).Theshadednodesarethedominantgeno-
typesshownin
Fig.11
.Thelengthofagivenpathdoesnotnecessarilyequalthe
numberofnucleotidemutations:QA
¡
LA
¡
SArequiresmultiplemutations
withintheLeu-codingcodons.
0 60 120 180240300
Time (days)
0.0
0.2
0.4
0.6
0.8
1.0
Mean frequency
HTQG 
(WT)
HAQG
QAQG
LAQG
SAQG 
(MF)
FIG11
Meanfrequenciesofthetop˚vedominantgenotypesasfunctionsof
timefromthein˜uenzavirusadaptationsimulations.Upto10
3
realizations
undertheconditionof
Fig.9
wereaveraged.Othergenotypesnotshownhave
meanfrequencieslessthan1%.
WooandReifman
1048
jvi.asm.org
JournalofVirology

code(
Fig.10
).The˚rstchange(T156A)occurredalmostimme-
diately(
t

3days),drivenbothbyalarge˚tnessincrease(4.9
¡
12.3)andbytheproximityofThr-andAla-codingcodons.The

remaining part of the trajectory and the time evolution of mean

frequencies of dominant genotypes (
Fig. 11
) show the typical dy-
namicalpatternsofadaptiveevolutionwefoundinthesesimula-

tions:fairlylongperiodsofdriftinwhichthemastersequence

remainsunchanged,whilethegroupofminoritygenotypeskeeps

evolving(thequasispeciesﬁexploresﬂtheimmediateneighbor-

hoodofanestablishedpeak),thegradualgrowthinfrequencyof

some minor variants, one of which takes over as the new master

sequence,andtheeventualdiscoveryoftheglobalMF.Thelast

eventoccurredonlyin10%ofthesimulationrunswithin

300
days(
Fig.11
),butifitdidoccur,theMFinvariablybecamedom-
inant.Theseriesofaminoacidchangesatposition103(H
¡
R
¡
L
¡
S)anditstimingin
Fig.9
aretheresultsofthecompromise
between˚tnessgains(
Fig. 8B
)andthenucleotidesubstitution
required:e.g.,CAT
¡
CGT
¡
CTT
¡
TCT,thelaststeprequiring
twosubstitutions,explainingtherareoccurrenceofSAQGasthe

master sequence within the timescale of

100 days (
Fig. 11
).
The experimental MF genotypes for positions 103 and 156 are
TyrandAla,respectively.ThegenotypeYAQGhadarelativelylow

˚tnessinourinferredlandscape(ranked19in
Fig.8B
),andits
frequencyremainedlowinthesimulations.Thisdiscrepancyis

primarilyduetotheinadequacyofthesequencedataunderlying

theinferredlandscape,underrepresentingrarecompensatory

mutations.Inaddition,itre˜ectsboththeconstraintsimposedby

the˚tnessgradient(
Fig.8B
)andthegeneticcode:thegenotype
YAisonlyaccessiblefromtheWT(HT)viaHAbutinvolvesa

˚tness decrease (
Fig. 10
).
Wemayinferinsightsintoabetterunderstandingofevolu-
tionarydynamicsofviralpathogensinnaturalsettingsfromthe

studyofserialpassages.Systematicinvestigationoftheeffectsof

factorsin˜uencingtherelativeeaseofspeciesjump,suchasthose

shown in
Fig. 6
, can play important roles in such interpretations.
For instance, the host cell number and bottleneck size roughly

correspondtothesizeofsusceptiblehostpopulationsandthe

degreeandseverityofselectionpresentduringthenaturalspread

ofaviralinfection,whereastheinfectionanddeathratescharac-

terize the population dynamics within this host environment. In

thisviewpoint,thelongitudinalpatternsofpopulationsizeand

quasispecies structure shown in
Fig. 3
can be regarded as idealiza-
tionsofwhattypicallyhappensinnaturalinfectiouscycles:aviral

strainventuresintoanewhostenvironment,completingmultiple

cyclesofrapidgrowthfollowedbystagnationduetohostdeple-

tionandreemergenceinafreshhostpopulation,butwithfactors

characterizingeachroundhighlyvariableandunpredictable

ratherthanuniformasinpassages.Ourstudyofevolutionary

dynamicsunderpassagessuggeststhatadaptationmostlyoccurs

intheearlygrowthphase(
Fig.3
),anadaptingviralpopulation
may frequently get stuck without a direct route to a neighboring

highly˚tstrain(
Fig.4
),andthespeedofadaptationismostsen-
sitivetothedistance(
Fig. 5
)andtarget/bottlenecksizes(
Fig. 6
).
Thespeci˚cinstanceofadaptationsimulatedundertheempiri-

callyderivedin˜uenzaAvirus˚tnesslandscape(
Fig.8
)explicitly
demonstratesthatinreality,aquasispeciesadaptationinvolvesthe

stochasticevolutionofboththemastersequenceanditsclouds

(
Fig.9
and
11
),insteadofasimplejumpfromtheWTgenotypeto
a global MF sequence.
Werestrictedourstudytotheevolutionarydynamicsofsmall
genomicsegmentsontheorderofafewaminoacids.Withthe
empiricalinferenceof˚tnesslandscapesfromMSAs,however,itis

conceivable to expand the scope to larger domains, possibly con-

tainingmultipleproteins,withthedirectcouplinganalysistaking

intoaccountcorrelatedevolutionofmultipleaminoacidsites.In

addition,inmodelingin˜uenzavirusevolutionwithlarge

genomicsegments,anextensiontakingintoaccountreassortment

eventsthatplayimportantrolesinin˜uenzavirusadaptation(
7
,
26
,
52
) could provide more realistic descriptions.
ACKNOWLEDGMENTS
ThisworkwassupportedbyacompetitiveIn-HouseLaboratoryIndepen-
dentResearchAwardbytheU.S.ArmyAssistantSecretaryoftheArmyfor

Acquisition,Logistics,andTechnology,andbytheU.S.ArmyMedical

ResearchandMaterielCommand(Ft.Detrick,Maryland).
Theopinionsandassertionscontainedhereinaretheprivateviewsof
theauthorsandarenottobeconstruedasof˚cialorasre˜ectingtheviews

oftheU.S.ArmyoroftheU.S.DepartmentofDefense.
REFERENCES
1.
DomingoE,HollandJJ.
1997.RNAvirusmutationsand˚tnessfor
survival.Annu.Rev.Microbiol.
51:
151Œ178.
http://dx.doi.org/10.1146
/annurev.micro.51.1.151
.
2.
HolmesEC.
2009.TheevolutionandemergenceofRNAviruses.Oxford
UniversityPress,Oxford,UnitedKingdom.
3.
PengX,ChanEY,LiY,DiamondDL,KorthMJ,KatzeMG.
2009.
Virus-host interactions: from systems biology to translational research.

Curr. Opin. Microbiol.
12:
432Œ438.
http://dx.doi.org/10.1016/j.mib.2009
.06.003
.
4.
Law GL, Korth MJ, Benecke AG, Katze MG.
2013. Systems virology:
host-directedapproachestoviralpathogenesisanddrugtargeting.Nat.

Rev.Microbiol.
11:
455Œ466.
http://dx.doi.org/10.1038/nrmicro3036
.
5.
PepinKM,LassS,PulliamJRC,ReadAF,Lloyd-SmithJO.
2010.
Identifying genetic markers of adaptation for surveillance of viral host

jumps.Nat.Rev.Microbiol.
8:
802Œ813.
http://dx.doi.org/10.1038
/nrmicro2440
.
6.
HerfstS,SchrauwenEJ,LinsterM,ChutinimitkulS,deWitE,Munster
VJ,SorrellEM,BestebroerTM,BurkeDF,SmithDJ,RimmelzwaanGF,

OsterhausAD,FouchierRA.
2012.Airbornetransmissionofin˜uenza
A/H5N1virusbetweenferrets.Science
336:
1534Œ1541.
http://dx.doi.org
/10.1126/science.1213362
.
7.
HolmesEC,GhedinE,MillerN,TaylorJ,BaoY,StGeorgeK,Grenfell
BT,SalzbergSL,FraserCM,LipmanDJ,TaubenbergerJK.
2005.
Whole-genomeanalysisofhumanin˜uenzaAvirusrevealsmultipleper-

sistentlineagesandreassortmentamongrecentH3N2viruses.PLoSBiol.

3:
e300.
http://dx.doi.org/10.1371/journal.pbio.0030300
.
8.
SmithDJ,LapedesAS,deJongJC,BestebroerTM,RimmelzwaanGF,
OsterhausAD,FouchierRA.
2004.Mappingtheantigenicandgenetic
evolutionofin˜uenzavirus.Science
305:
371Œ376.
http://dx.doi.org/10
.1126/science.1097211
.
9.
Josset L, Belser JA, Pantin-Jackwood MJ, Chang JH, Chang ST, Belisle
SE,TumpeyTM,KatzeMG.
2012.Implicationofin˜ammatorymacro-
phages, nuclear receptors, and interferon regulatory factors in increased

virulenceofpandemic2009H1N1in˜uenzaAvirusafterhostadaptation.

J.Virol.
86:
7192Œ7206.
http://dx.doi.org/10.1128/JVI.00563-12
.
10.
BollesM,DonaldsonE,BaricR.
2011.SARS-CoVandemergentcoro-
naviruses:viraldeterminantsofinterspeciestransmission.Curr.Opin.

Virol.
1:
624Œ634.
http://dx.doi.org/10.1016/j.coviro.2011.10.012
.
11.
GrahamRL,BaricRS.
2010.Recombination,reservoirs,andthemodular
spike:mechanismsofcoronaviruscross-speciestransmission.J.Virol.
84:
3134Œ3146.
http://dx.doi.org/10.1128/JVI.01394-09
.
12.
Sheahan T, Rockx B, Donaldson E, Sims A, Pickles R, Corti D, Baric R.
2008. Mechanisms of zoonotic severe acute respiratory syndrome corona-

virus host range expansion in human airway epithelium. J. Virol.
82:
2274Œ2285.
http://dx.doi.org/10.1128/JVI.02041-07
.
13.
WuK,PengG,WilkenM,GeraghtyRJ,LiF.
2012.Mechanismsofhost
receptor adaptation by severe acute respiratory syndromecoronavirus. J. Biol.

Chem.
287:
8904Œ8911.
http://dx.doi.org/10.1074/jbc.M111.325803
.
14.
GaoF,BailesE,RobertsonDL,ChenY,RodenburgCM,MichaelSF,
ModelingVirusAdaptationunderSerialPassages
January2014Volume88Number2
jvi.asm.org
1049

CumminsLB,ArthurLO,PeetersM,ShawGM,SharpPM,HahnBH.
1999.OriginofHIV-1inthechimpanzeePantroglodytestroglodytes.

Nature
397:
436Œ441.
http://dx.doi.org/10.1038/17130
.
15.
EbertD.
1998.Experimentalevolutionofparasites.Science
282:
1432Œ
1435.
http://dx.doi.org/10.1126/science.282.5393.1432
.
16.
WebsterDP,FarrarJ,Rowland-JonesS.
2009.Progresstowardsadengue
vaccine.LancetInfect.Dis.
9:
678Œ687.
http://dx.doi.org/10.1016/S1473
-3099(09)70254-3
.
17.
MardisER.
2008.Next-generationDNAsequencingmethods.Annu.Rev.
GenomicsHum.Genet.
9:
387Œ402.
http://dx.doi.org/10.1146/annurev
.genom.9.081307.164359
.
18.
PerelsonAS,NeumannAU,MarkowitzM,LeonardJM,HoDD.
1996.
HIV-1dynamicsinvivo:virionclearancerate,infectedcelllife-span,and

viralgenerationtime.Science
271:
1582Œ1586.
http://dx.doi.org/10.1126
/science.271.5255.1582
.
19.
NowakMA,BanghamCR.
1996.Populationdynamicsofimmunere-
sponses to persistent viruses. Science
272:
74Œ79.
http://dx.doi.org/10
.1126/science.272.5258.74
.
20.
BaccamP,BeaucheminC,MackenCA,HaydenFG,PerelsonAS.
2006.
Kineticsofin˜uenzaAvirusinfectioninhumans.J.Virol.
80:
7590Œ7599.
http://dx.doi.org/10.1128/JVI.01623-05
.
21.
Lee HY, Perelson AS, Park SC, Leitner T.
2008. Dynamic correlation
betweenintrahostHIV-1quasispeciesevolutionanddiseaseprogression.

PLoSComput.Biol.
4:
e1000240.
http://dx.doi.org/10.1371/journal.pcbi
.1000240
.
22.
LimKI,LangT,LamV,YinJ.
2006.Model-baseddesignofgrowth-
attenuatedviruses.PLoSComput.Biol.
2:
e116.
http://dx.doi.org/10.1371
/journal.pcbi.0020116
.
23.
LimKI,YinJ.
2009.Computational˚tnesslandscapeforallgene-order
permutationsofanRNAvirus.PLoSComput.Biol.
5:
e1000283.
http://dx
.doi.org/10.1371/journal.pcbi.1000283
.
24.
Lázaro E, Escarmis C, Domingo E, Manrubia SC.
2002. Modeling viral
genome˚tnessevolutionassociatedwithserialbottleneckevents:evi-

denceofstationarystatesof˚tness.J.Virol.
76:
8675Œ8681.
http://dx.doi
.org/10.1128/JVI.76.17.8675-8681.2002
.
25.
LázaroE,EscarmisC,Perez-MercaderJ,ManrubiaSC,DomingoE.
2003.Resistanceofvirustoextinctiononbottleneckpassages:studyofa

decayingand˜uctuatingpatternof˚tnessloss.Proc.Natl.Acad.Sci.

U.S.A.
100:
10830Œ10835.
http://dx.doi.org/10.1073/pnas.1332668100
.
26.
RussellCA,FonvilleJM,BrownAE,BurkeDF,SmithDL,JamesSL,
Herfst S, van Boheemen S, Linster M, Schrauwen EJ, Katzelnick L,

MosterínA,KuikenT,MaherE,NeumannG,OsterhausAD,Kawaoka

Y,FouchierRA,SmithDJ.
2012.Thepotentialforrespiratorydroplet-
transmissibleA/H5N1in˜uenzavirustoevolveinamammalianhost.

Science
336:
1541Œ1547.
http://dx.doi.org/10.1126/science.1222526
.
27.
ImaiM,WatanabeT,HattaM,DasSC,OzawaM,ShinyaK,ZhongG,
HansonA,KatsuraH,WatanabeS,LiC,KawakamiE,YamadaS,Kiso

M, Suzuki Y, Maher EA, Neumann G, Kawaoka Y.
2012. Experimental
adaptationofanin˜uenzaH5HAconfersrespiratorydroplettransmis-

siontoareassortantH5HA/H1N1virusinferrets.Nature
486:
420Œ428.
28.
WooHJ,ReifmanJ.
2012.Aquantitativequasispeciestheory-based
modelofvirusescapemutationunderimmuneselection.Proc.Natl.

Acad.Sci.U.S.A.
109:
12980Œ12985.
http://dx.doi.org/10.1073/pnas
.1117201109
.
29.
EigenM.
1971.Selforganizationofmatterandtheevolutionofbiological
macromolecules.Naturwissenschaften
58:
465Œ523.
http://dx.doi.org/10
.1007/BF00623322
.
30.
SwetinaJ,SchusterP.
1982.Self-replicationwitherrors:amodelfor
polynucleotidereplication.Biophys.Chem.
16:
329Œ345.
http://dx.doi
.org/10.1016/0301-4622(82)87037-3
.
31.
GillespieDT.
1977.Exactstochasticsimulationofcoupledchemical
reactions.J.Phys.Chem.
81:
2340Œ2361.
http://dx.doi.org/10.1021
/j100540a008
.
32.
WeigtM,WhiteRA,SzurmantH,HochJA,HwaT.
2009.Identi˚cation
ofdirectresiduecontactsinprotein-proteininteractionbymessagepass-

ing.Proc.Natl.Acad.Sci.U.S.A.
106:
67Œ72.
http://dx.doi.org/10.1073
/pnas.0805923106
.
33.
MorcosF,PagnaniA,LuntB,BertolinoA,MarksDS,SanderC,
ZecchinaR,OnuchicJN,HwaT,WeigtM.
2011.Direct-coupling
analysisofresiduecoevolutioncapturesnativecontactsacrossmanypro-
teinfamilies.Proc.Natl.Acad.Sci.U.S.A.
108:
E1293ŒE1301.
http://dx
.doi.org/10.1073/pnas.1111471108
.
34.
FergusonAL,MannJK,OmarjeeS,Ndung™uT,WalkerBD,
ChakrabortyAK.
2013.TranslatingHIVsequencesintoquantitative˚t-
nesslandscapespredictsviralvulnerabilitiesforrationalimmunogende-

sign.Immunity
38:
606Œ617.
http://dx.doi.org/10.1016/j.immuni.2012.11
.022
.
35.
Bao Y, Bolotov P, Dernovoy D, Kiryutin B, Zaslavsky L, Tatusova T,
OstellJ,Lipman D.
2008.Thein˜uenzavirusresourceattheNational
CenterforBiotechnologyInformation.J.Virol.
82:
596Œ601.
http://dx.doi
.org/10.1128/JVI.02005-07
.
36.
JonesDT,TaylorWR,ThorntonJM.
1992.Therapidgenerationof
mutationdatamatricesfromproteinsequences.Comput.Appl.Biosci.

8:
275Œ282.
37.
PawelekKA,HuynhGT,QuinlivanM,CullinaneA,RongL,Perelson
AS.
2012.Modelingwithin-hostdynamicsofin˜uenzavirusinfection
includingimmuneresponses.PLoSComput.Biol.
8:
e1002588.
http://dx
.doi.org/10.1371/journal.pcbi.1002588
.
38.
MurphyBR,RennelsMB,DouglasRG,Jr,BettsRF,CouchRB,Cate
TR,Jr,ChanockRM,KendalAP,MaassabHF,SuwanagoolS,Sotman

SB,CisnerosLA,AnthonyWC,NalinDR,LevineMM.
1980.Evaluation
of in˜uenza A/Hong Kong/123/77 (H1N1)
ts
-1A2 and cold-adapted re-
combinant viruses in seronegative adult volunteers. Infect. Immun.
29:
348Œ355.
39.
NobusawaE,SatoK.
2006.Comparisonofthemutationratesofhuman
in˜uenzaAandBviruses.J.Virol.
80:
3675Œ3678.
http://dx.doi.org/10
.1128/JVI.80.7.3675-3678.2006
.
40.
GagoS,ElenaSF,FloresR,SanjuanR.
2009.Extremelyhighmutation
rateofahammerheadviroid.Science
323:
1308.
http://dx.doi.org/10.1126
/science.1169202
.
41.
YangZ.
1994.MaximumlikelihoodphylogeneticestimationfromDNA
sequenceswithvariableratesoversites:approximatemethods.J.Mol.

Evol.
39:
306Œ314.
http://dx.doi.org/10.1007/BF00160154
.
42.
KampmannML, Fordyce SL, Avila-Arcos MC, RasmussenM,Willer-
slevE,NielsenLP,GilbertMT.
2011.Asimplemethodfortheparallel
deepsequencingoffullin˜uenzaAgenomes.J.Virol.Methods
178:
243Œ
248.
http://dx.doi.org/10.1016/j.jviromet.2011.09.001
.
43.
BarnardDL.
2009.Animalmodelsforthestudyofin˜uenzapathogenesis
andtherapy.AntiviralRes.
82:
A110ŒA122.
http://dx.doi.org/10.1016/j
.antiviral.2008.12.014
.
44.
BouvierNM,LowenAC.
2010.Animalmodelsforin˜uenzaviruspatho-
genesisandtransmission.Viruses
2:
1530Œ1563.
http://dx.doi.org/10.3390
/v20801530
.
45.
ChutinimitkulS,vanRielD,MunsterVJ,vandenBrandJM,Rimmel-
zwaanGF,KuikenT,OsterhausAD,FouchierRA,deWitE.
2010.
In
vitro
assessmentofattachmentpatternandreplicationef˚ciencyofH5N1
in˜uenzaAviruseswithalteredreceptorspeci˚city.J.Virol.
84:
6825Œ
6833.
http://dx.doi.org/10.1128/JVI.02737-09
.
46.
ZhangW,ShiY,LuX,ShuY,QiJ,GaoGF.
2013.Anairborne
transmissibleavianin˜uenzaH5hemagglutininseenattheatomiclevel.

Science
340:
1463Œ1467.
http://dx.doi.org/10.1126/science.1236787
.
47.
ManskyLM,TeminHM.
1995.Lowerinvivomutationrateofhuman
immunode˚ciencyvirustype1thanthatpredictedfromthe˚delityof

puri˚edreversetranscriptase.J.Virol.
69:
5087Œ5094.
48.
FernàndezG,ClotetB,MartinezMA.
2007.Fitnesslandscapeofhuman
immunode˚ciencyvirustype1proteasequasispecies.J.Virol.
81:
2485Œ
2496.
http://dx.doi.org/10.1128/JVI.01594-06
.
49.
AguirreJ,BulduJM,StichM,ManrubiaSC.
2011.Topologicalstructure
ofthespaceofphenotypes:thecaseofRNAneutralnetworks.PLoSOne

6:
e26324.
http://dx.doi.org/10.1371/journal.pone.0026324
.
50.
KauffmanSA.
1993.Theoriginsoforder:self-organizationandselection
inevolution.OxfordUniversityPress,Oxford,UnitedKingdom.
51.
Li F, Li W, Farzan M, Harrison SC.
2005. Structure of SARS coronavirus
spikereceptor-bindingdomaincomplexedwithreceptor.Science
309:
1864Œ1868.
http://dx.doi.org/10.1126/science.1116480
.
52.
InceWL,Gueye-MbayeA,BenninkJR,YewdellJW.
2013.Reassortment
complementsspontaneousmutationinin˜uenzaAvirusNPandM1

genestoaccelerateadaptationtoanewhost.J.Virol.
87:
4330Œ4338.
http:
//dx.doi.org/10.1128/JVI.02749-12
.
WooandReifman
1050
jvi.asm.org
JournalofVirology


